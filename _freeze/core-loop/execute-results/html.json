{
  "hash": "10bc53a29a48f9131f1068c225b78c43",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Notes on the core loop of the ABM\"\nauthor: David O'Sullivan\ndate: 2 July 2024\nexecute: \n  cache: true\n  freeze: auto\nformat:\n  html:\n    toc: true\n    toc-depth: 4\n    toc-title: \"Contents\"\n    code-fold: true\n    html-math-method: katex\n    embed-resources: true\nknitr:\n  opts_chunk: \n    warning: false\n    message: false\n    # echo: false\n    R.options: \n      knitr.table.html.attr: \"quarto-disable-processing=true\"\n---\n\n::: {.cell}\n\n:::\n\n\nThese notes are intended to make it easier to discuss with colleagues if we are approaching the core decision loop in the agent-based model (ABM) for 'Moving the Middle' (MtM) in a coherent and reasonable way.\n\n## Baseline income equation for farms\nThe baseline net revenue $R$ of each hectare of a farm is given by\n\n$$R=Y-X$$\n\nwhere $Y$ is gross revenue, and $X$ is total costs. These are in turn given by\n\n$$\n\\begin{matrix}\nY & = & pq\\\\\nX & = & \\left(x+te\\right)\n\\end{matrix}\n$$\n\nwhere \n\n- $p$ is the price obtained per unit, \n- $q$ is the quantity produced per hectare,\n- $x$ is the cost per hectare to operate,\n- $e$ is the greenhouse gas emissions per hectare, and \n- $t$ is the tax on each unit of emissions.\n\nEach of these parameters may depend on the _farm type_ $F$ (one of Crops, Dairy, Forestry, or Sheep/Beef) and the _land use capability_ (LUC), $L$, such that the full calculation of revenue for each hectare of a farm is\n$$\nR_{FL} = p_Fq_{FL} - x_{FL} - te_{FL}\n$$\nand total farm revenue is obtaining by summing this quantity across all hectares of the farm (which may be of varying landuse capability $L$).\n\n### Parameter values\nThe parameter values are stored in a number of CSV files which are read in by the model at start up.\n\n#### Prices \n$p_F$ and the greenhouse gas tax (i.e. carbon price), $t$, are in the `prices.csv` file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprices <- read.csv(\"data/market/prices.csv\", \n                   header = T, row.names = 1) |> \n  slice(1:2) # only rows 1 & 2 relevant\nprices |> \n  kable() |> \n  kable_styling(\"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table quarto-disable-processing=\"true\" class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> SNB </th>\n   <th style=\"text-align:right;\"> Dairy </th>\n   <th style=\"text-align:right;\"> Forest </th>\n   <th style=\"text-align:right;\"> Crop </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Price_Commodity </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 157 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Price_GhG </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 25.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 25.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Yields \nYields by farm type and landuse capability, $q_{FL}$, are in the `commodity-yields.csv` file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyields <- read.csv(\"data/market/commodity-yields.csv\", \n                   header = T, row.names = 1)\nyields |> \n  kable() |> \n  kable_styling(\"striped\", full_width = F) |>\n  scroll_box(height = \"250px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:250px; \"><table quarto-disable-processing=\"true\" class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\">  </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> SNB </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Dairy </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Forest </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Crop </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> LUC1_Mean </td>\n   <td style=\"text-align:right;\"> 768.505660 </td>\n   <td style=\"text-align:right;\"> 1503.0000 </td>\n   <td style=\"text-align:right;\"> 30.0 </td>\n   <td style=\"text-align:right;\"> 9667.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC1_SD </td>\n   <td style=\"text-align:right;\"> 153.701132 </td>\n   <td style=\"text-align:right;\"> 300.6000 </td>\n   <td style=\"text-align:right;\"> 6.0 </td>\n   <td style=\"text-align:right;\"> 1933.400 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC2_Mean </td>\n   <td style=\"text-align:right;\"> 581.247332 </td>\n   <td style=\"text-align:right;\"> 1283.0000 </td>\n   <td style=\"text-align:right;\"> 29.0 </td>\n   <td style=\"text-align:right;\"> 9183.650 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC2_SD </td>\n   <td style=\"text-align:right;\"> 116.249466 </td>\n   <td style=\"text-align:right;\"> 256.6000 </td>\n   <td style=\"text-align:right;\"> 5.8 </td>\n   <td style=\"text-align:right;\"> 1836.730 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC3_Mean </td>\n   <td style=\"text-align:right;\"> 372.371287 </td>\n   <td style=\"text-align:right;\"> 1174.3000 </td>\n   <td style=\"text-align:right;\"> 28.0 </td>\n   <td style=\"text-align:right;\"> 8724.468 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC3_SD </td>\n   <td style=\"text-align:right;\"> 74.474257 </td>\n   <td style=\"text-align:right;\"> 234.8600 </td>\n   <td style=\"text-align:right;\"> 5.6 </td>\n   <td style=\"text-align:right;\"> 1744.893 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC4_Mean </td>\n   <td style=\"text-align:right;\"> 332.178378 </td>\n   <td style=\"text-align:right;\"> 923.3900 </td>\n   <td style=\"text-align:right;\"> 27.0 </td>\n   <td style=\"text-align:right;\"> 8288.244 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC4_SD </td>\n   <td style=\"text-align:right;\"> 66.435676 </td>\n   <td style=\"text-align:right;\"> 184.6780 </td>\n   <td style=\"text-align:right;\"> 5.4 </td>\n   <td style=\"text-align:right;\"> 1657.649 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC5_Mean </td>\n   <td style=\"text-align:right;\"> 259.480336 </td>\n   <td style=\"text-align:right;\"> 877.7308 </td>\n   <td style=\"text-align:right;\"> 26.0 </td>\n   <td style=\"text-align:right;\"> 7873.832 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC5_SD </td>\n   <td style=\"text-align:right;\"> 51.896067 </td>\n   <td style=\"text-align:right;\"> 175.5462 </td>\n   <td style=\"text-align:right;\"> 5.2 </td>\n   <td style=\"text-align:right;\"> 1574.766 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC6_Mean </td>\n   <td style=\"text-align:right;\"> 207.386971 </td>\n   <td style=\"text-align:right;\"> 845.7812 </td>\n   <td style=\"text-align:right;\"> 25.0 </td>\n   <td style=\"text-align:right;\"> 7480.140 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC6_SD </td>\n   <td style=\"text-align:right;\"> 41.477394 </td>\n   <td style=\"text-align:right;\"> 169.1562 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 1496.028 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC7_Mean </td>\n   <td style=\"text-align:right;\"> 193.188428 </td>\n   <td style=\"text-align:right;\"> 700.0000 </td>\n   <td style=\"text-align:right;\"> 24.0 </td>\n   <td style=\"text-align:right;\"> 7106.133 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC7_SD </td>\n   <td style=\"text-align:right;\"> 38.637686 </td>\n   <td style=\"text-align:right;\"> 140.0000 </td>\n   <td style=\"text-align:right;\"> 4.8 </td>\n   <td style=\"text-align:right;\"> 1421.227 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC8_Mean </td>\n   <td style=\"text-align:right;\"> 49.945208 </td>\n   <td style=\"text-align:right;\"> 661.0000 </td>\n   <td style=\"text-align:right;\"> 23.0 </td>\n   <td style=\"text-align:right;\"> 6750.827 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC8_SD </td>\n   <td style=\"text-align:right;\"> 9.989042 </td>\n   <td style=\"text-align:right;\"> 132.2000 </td>\n   <td style=\"text-align:right;\"> 4.6 </td>\n   <td style=\"text-align:right;\"> 1350.165 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n#### Costs \nCosts per ha. by farm type and landuse capability, $x_{FL}$, are in the `input-costs.csv` file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncosts <- read.csv(\"data/market/input-costs.csv\", \n                   header = T, row.names = 1)\ncosts |> \n  kable() |> \n  kable_styling(\"striped\", full_width = F) |>\n  scroll_box(height = \"250px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:250px; \"><table quarto-disable-processing=\"true\" class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\">  </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> SNB </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Dairy </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Forest </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Crop </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> LUC1_Mean </td>\n   <td style=\"text-align:right;\"> 3500 </td>\n   <td style=\"text-align:right;\"> 9500 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC1_SD </td>\n   <td style=\"text-align:right;\"> 700 </td>\n   <td style=\"text-align:right;\"> 1900 </td>\n   <td style=\"text-align:right;\"> 800 </td>\n   <td style=\"text-align:right;\"> 600 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC2_Mean </td>\n   <td style=\"text-align:right;\"> 2650 </td>\n   <td style=\"text-align:right;\"> 8050 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> 2850 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC2_SD </td>\n   <td style=\"text-align:right;\"> 530 </td>\n   <td style=\"text-align:right;\"> 1610 </td>\n   <td style=\"text-align:right;\"> 800 </td>\n   <td style=\"text-align:right;\"> 570 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC3_Mean </td>\n   <td style=\"text-align:right;\"> 1625 </td>\n   <td style=\"text-align:right;\"> 7350 </td>\n   <td style=\"text-align:right;\"> 3850 </td>\n   <td style=\"text-align:right;\"> 2675 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC3_SD </td>\n   <td style=\"text-align:right;\"> 325 </td>\n   <td style=\"text-align:right;\"> 1470 </td>\n   <td style=\"text-align:right;\"> 770 </td>\n   <td style=\"text-align:right;\"> 535 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC4_Mean </td>\n   <td style=\"text-align:right;\"> 1450 </td>\n   <td style=\"text-align:right;\"> 5500 </td>\n   <td style=\"text-align:right;\"> 3700 </td>\n   <td style=\"text-align:right;\"> 2500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC4_SD </td>\n   <td style=\"text-align:right;\"> 290 </td>\n   <td style=\"text-align:right;\"> 1100 </td>\n   <td style=\"text-align:right;\"> 740 </td>\n   <td style=\"text-align:right;\"> 500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC5_Mean </td>\n   <td style=\"text-align:right;\"> 1110 </td>\n   <td style=\"text-align:right;\"> 5200 </td>\n   <td style=\"text-align:right;\"> 3550 </td>\n   <td style=\"text-align:right;\"> 2400 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC5_SD </td>\n   <td style=\"text-align:right;\"> 222 </td>\n   <td style=\"text-align:right;\"> 1040 </td>\n   <td style=\"text-align:right;\"> 710 </td>\n   <td style=\"text-align:right;\"> 480 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC6_Mean </td>\n   <td style=\"text-align:right;\"> 875 </td>\n   <td style=\"text-align:right;\"> 5000 </td>\n   <td style=\"text-align:right;\"> 3500 </td>\n   <td style=\"text-align:right;\"> 2200 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC6_SD </td>\n   <td style=\"text-align:right;\"> 175 </td>\n   <td style=\"text-align:right;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 700 </td>\n   <td style=\"text-align:right;\"> 440 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC7_Mean </td>\n   <td style=\"text-align:right;\"> 810 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> 3375 </td>\n   <td style=\"text-align:right;\"> 2100 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC7_SD </td>\n   <td style=\"text-align:right;\"> 162 </td>\n   <td style=\"text-align:right;\"> 800 </td>\n   <td style=\"text-align:right;\"> 675 </td>\n   <td style=\"text-align:right;\"> 420 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC8_Mean </td>\n   <td style=\"text-align:right;\"> 125 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> 3250 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC8_SD </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 800 </td>\n   <td style=\"text-align:right;\"> 650 </td>\n   <td style=\"text-align:right;\"> 400 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n#### Emissions\nEmissions per ha. by farm type and landuse capability, $e_{FL}$, are in the `ghg-emissions.csv` file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nemissions <- read.csv(\"data/market/ghg-emissions.csv\", \n                      header = T, row.names = 1)\nemissions |> \n  kable() |> \n  kable_styling(\"striped\", full_width = F) |>\n  scroll_box(height = \"250px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:250px; \"><table quarto-disable-processing=\"true\" class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\">  </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> SNB </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Dairy </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Forest </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Crop </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> LUC1_Mean </td>\n   <td style=\"text-align:right;\"> 4.000 </td>\n   <td style=\"text-align:right;\"> 11.00 </td>\n   <td style=\"text-align:right;\"> -15.000000 </td>\n   <td style=\"text-align:right;\"> 1.2000000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC1_SD </td>\n   <td style=\"text-align:right;\"> 1.200 </td>\n   <td style=\"text-align:right;\"> 3.30 </td>\n   <td style=\"text-align:right;\"> 4.500000 </td>\n   <td style=\"text-align:right;\"> 0.3600000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC2_Mean </td>\n   <td style=\"text-align:right;\"> 3.750 </td>\n   <td style=\"text-align:right;\"> 10.50 </td>\n   <td style=\"text-align:right;\"> -14.250000 </td>\n   <td style=\"text-align:right;\"> 1.1400000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC2_SD </td>\n   <td style=\"text-align:right;\"> 1.125 </td>\n   <td style=\"text-align:right;\"> 3.15 </td>\n   <td style=\"text-align:right;\"> 4.275000 </td>\n   <td style=\"text-align:right;\"> 0.3420000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC3_Mean </td>\n   <td style=\"text-align:right;\"> 3.500 </td>\n   <td style=\"text-align:right;\"> 10.00 </td>\n   <td style=\"text-align:right;\"> -13.537500 </td>\n   <td style=\"text-align:right;\"> 1.0830000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC3_SD </td>\n   <td style=\"text-align:right;\"> 1.050 </td>\n   <td style=\"text-align:right;\"> 3.00 </td>\n   <td style=\"text-align:right;\"> 4.061250 </td>\n   <td style=\"text-align:right;\"> 0.3249000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC4_Mean </td>\n   <td style=\"text-align:right;\"> 3.250 </td>\n   <td style=\"text-align:right;\"> 9.50 </td>\n   <td style=\"text-align:right;\"> -12.860625 </td>\n   <td style=\"text-align:right;\"> 1.0288500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC4_SD </td>\n   <td style=\"text-align:right;\"> 0.975 </td>\n   <td style=\"text-align:right;\"> 2.85 </td>\n   <td style=\"text-align:right;\"> 3.858188 </td>\n   <td style=\"text-align:right;\"> 0.3086550 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC5_Mean </td>\n   <td style=\"text-align:right;\"> 3.000 </td>\n   <td style=\"text-align:right;\"> 9.00 </td>\n   <td style=\"text-align:right;\"> -12.217594 </td>\n   <td style=\"text-align:right;\"> 0.9774075 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC5_SD </td>\n   <td style=\"text-align:right;\"> 0.900 </td>\n   <td style=\"text-align:right;\"> 2.70 </td>\n   <td style=\"text-align:right;\"> 3.665278 </td>\n   <td style=\"text-align:right;\"> 0.2932223 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC6_Mean </td>\n   <td style=\"text-align:right;\"> 2.750 </td>\n   <td style=\"text-align:right;\"> 8.50 </td>\n   <td style=\"text-align:right;\"> -11.606714 </td>\n   <td style=\"text-align:right;\"> 0.9285371 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC6_SD </td>\n   <td style=\"text-align:right;\"> 0.825 </td>\n   <td style=\"text-align:right;\"> 2.55 </td>\n   <td style=\"text-align:right;\"> 3.482014 </td>\n   <td style=\"text-align:right;\"> 0.2785611 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC7_Mean </td>\n   <td style=\"text-align:right;\"> 2.500 </td>\n   <td style=\"text-align:right;\"> 8.00 </td>\n   <td style=\"text-align:right;\"> -11.026378 </td>\n   <td style=\"text-align:right;\"> 0.8821103 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC7_SD </td>\n   <td style=\"text-align:right;\"> 0.750 </td>\n   <td style=\"text-align:right;\"> 2.40 </td>\n   <td style=\"text-align:right;\"> 3.307914 </td>\n   <td style=\"text-align:right;\"> 0.2646331 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC8_Mean </td>\n   <td style=\"text-align:right;\"> 2.250 </td>\n   <td style=\"text-align:right;\"> 7.50 </td>\n   <td style=\"text-align:right;\"> -10.475059 </td>\n   <td style=\"text-align:right;\"> 0.8380048 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> LUC8_SD </td>\n   <td style=\"text-align:right;\"> 0.675 </td>\n   <td style=\"text-align:right;\"> 2.25 </td>\n   <td style=\"text-align:right;\"> 3.142518 </td>\n   <td style=\"text-align:right;\"> 0.2514014 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\nNote that all of yields, costs, and emissions are stored as a mean and a standard deviation, and that individual hectare sites will see these numbers vary every model time period by drawing from a normal distribution.\n\nWe can use these data to show the revenue and costs for each farm type across different landuse capability classes. We'll throw away the standard deviations for simplicity and consider only mean outcomes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprices <- prices |> \n  t() |> \n  as.data.frame() |> \n  tibble::rownames_to_column(\"farm_type\") |>\n  rename(price = Price_Commodity, carbon_tax = Price_GhG) |>\n  slice(rep(row_number(), 8)) |>\n  mutate(LUC = rep(1:8, each = 4))\n\nyields <- yields |>\n  slice(seq(1, 15, 2)) |> \n  t() |> \n  as.data.frame() |> \n  tibble::rownames_to_column(\"farm_type\") |>\n  pivot_longer(-1) |>\n  mutate(LUC = rep(1:8, 4), yield = round(value, 1)) |>\n  select(farm_type, LUC, yield)\n\ncosts <- costs |>\n  slice(seq(1, 15, 2)) |> \n  t() |> \n  as.data.frame() |> \n  tibble::rownames_to_column(\"farm_type\") |>\n  pivot_longer(-1) |>\n  mutate(LUC = rep(1:8, 4), costs = round(value, 1)) |>\n  select(farm_type, LUC, costs)\n\nemissions <- emissions |> \n  slice(seq(1, 15, 2)) |> \n  t() |> \n  as.data.frame() |> \n  tibble::rownames_to_column(\"farm_type\") |>\n  pivot_longer(-1) |>\n  mutate(LUC = rep(1:8, 4), emissions = round(value, 1)) |>\n  select(farm_type, LUC, emissions)\n\ncombined_data <- prices |>\n  left_join(yields) |>\n  left_join(costs) |>\n  left_join(emissions) |>\n  mutate(income = price * yield, # LUC = as.factor(LUC),\n         total_costs = costs + carbon_tax * emissions,\n         revenue = income - total_costs) |>\n  select(farm_type, LUC, revenue, price, yield, income, costs,\n         emissions, carbon_tax, total_costs) |>\n  rename(Revenue = revenue, Income = income, `Total costs` = total_costs)\n\ncombined_data |> \n  kable() |> \n  kable_styling(\"striped\", full_width = F) |>\n  scroll_box(height = \"250px\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div style=\"border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:250px; \"><table quarto-disable-processing=\"true\" class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;position: sticky; top:0; background-color: #FFFFFF;\"> farm_type </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> LUC </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Revenue </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> price </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> yield </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Income </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> costs </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> emissions </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> carbon_tax </th>\n   <th style=\"text-align:right;position: sticky; top:0; background-color: #FFFFFF;\"> Total costs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 242.50 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 768.5 </td>\n   <td style=\"text-align:right;\"> 3842.50 </td>\n   <td style=\"text-align:right;\"> 3500 </td>\n   <td style=\"text-align:right;\"> 4.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3600.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1497.50 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 1503.0 </td>\n   <td style=\"text-align:right;\"> 11272.50 </td>\n   <td style=\"text-align:right;\"> 9500 </td>\n   <td style=\"text-align:right;\"> 11.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 9775.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1085.00 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 30.0 </td>\n   <td style=\"text-align:right;\"> 4710.00 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> -15.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3625.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1803.50 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 9667.0 </td>\n   <td style=\"text-align:right;\"> 4833.50 </td>\n   <td style=\"text-align:right;\"> 3000 </td>\n   <td style=\"text-align:right;\"> 1.2 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3030.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 161.00 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 581.2 </td>\n   <td style=\"text-align:right;\"> 2906.00 </td>\n   <td style=\"text-align:right;\"> 2650 </td>\n   <td style=\"text-align:right;\"> 3.8 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2745.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1310.00 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 1283.0 </td>\n   <td style=\"text-align:right;\"> 9622.50 </td>\n   <td style=\"text-align:right;\"> 8050 </td>\n   <td style=\"text-align:right;\"> 10.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 8312.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 908.00 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 29.0 </td>\n   <td style=\"text-align:right;\"> 4553.00 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> -14.2 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3645.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1714.30 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 9183.6 </td>\n   <td style=\"text-align:right;\"> 4591.80 </td>\n   <td style=\"text-align:right;\"> 2850 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2877.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 149.50 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 372.4 </td>\n   <td style=\"text-align:right;\"> 1862.00 </td>\n   <td style=\"text-align:right;\"> 1625 </td>\n   <td style=\"text-align:right;\"> 3.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 1712.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1207.25 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 1174.3 </td>\n   <td style=\"text-align:right;\"> 8807.25 </td>\n   <td style=\"text-align:right;\"> 7350 </td>\n   <td style=\"text-align:right;\"> 10.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 7600.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 883.50 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 28.0 </td>\n   <td style=\"text-align:right;\"> 4396.00 </td>\n   <td style=\"text-align:right;\"> 3850 </td>\n   <td style=\"text-align:right;\"> -13.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3512.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 1659.75 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 8724.5 </td>\n   <td style=\"text-align:right;\"> 4362.25 </td>\n   <td style=\"text-align:right;\"> 2675 </td>\n   <td style=\"text-align:right;\"> 1.1 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2702.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 131.00 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 332.2 </td>\n   <td style=\"text-align:right;\"> 1661.00 </td>\n   <td style=\"text-align:right;\"> 1450 </td>\n   <td style=\"text-align:right;\"> 3.2 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 1530.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1188.00 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 923.4 </td>\n   <td style=\"text-align:right;\"> 6925.50 </td>\n   <td style=\"text-align:right;\"> 5500 </td>\n   <td style=\"text-align:right;\"> 9.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 5737.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 861.50 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 27.0 </td>\n   <td style=\"text-align:right;\"> 4239.00 </td>\n   <td style=\"text-align:right;\"> 3700 </td>\n   <td style=\"text-align:right;\"> -12.9 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3377.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1619.10 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 8288.2 </td>\n   <td style=\"text-align:right;\"> 4144.10 </td>\n   <td style=\"text-align:right;\"> 2500 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2525.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 112.50 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 259.5 </td>\n   <td style=\"text-align:right;\"> 1297.50 </td>\n   <td style=\"text-align:right;\"> 1110 </td>\n   <td style=\"text-align:right;\"> 3.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 1185.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1157.75 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 877.7 </td>\n   <td style=\"text-align:right;\"> 6582.75 </td>\n   <td style=\"text-align:right;\"> 5200 </td>\n   <td style=\"text-align:right;\"> 9.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 5425.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 837.00 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 26.0 </td>\n   <td style=\"text-align:right;\"> 4082.00 </td>\n   <td style=\"text-align:right;\"> 3550 </td>\n   <td style=\"text-align:right;\"> -12.2 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3245.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 1511.90 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 7873.8 </td>\n   <td style=\"text-align:right;\"> 3936.90 </td>\n   <td style=\"text-align:right;\"> 2400 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2425.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 92.00 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 207.4 </td>\n   <td style=\"text-align:right;\"> 1037.00 </td>\n   <td style=\"text-align:right;\"> 875 </td>\n   <td style=\"text-align:right;\"> 2.8 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 945.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1131.00 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 845.8 </td>\n   <td style=\"text-align:right;\"> 6343.50 </td>\n   <td style=\"text-align:right;\"> 5000 </td>\n   <td style=\"text-align:right;\"> 8.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 5212.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 715.00 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 25.0 </td>\n   <td style=\"text-align:right;\"> 3925.00 </td>\n   <td style=\"text-align:right;\"> 3500 </td>\n   <td style=\"text-align:right;\"> -11.6 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3210.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1517.55 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 7480.1 </td>\n   <td style=\"text-align:right;\"> 3740.05 </td>\n   <td style=\"text-align:right;\"> 2200 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2222.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 93.50 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 193.2 </td>\n   <td style=\"text-align:right;\"> 966.00 </td>\n   <td style=\"text-align:right;\"> 810 </td>\n   <td style=\"text-align:right;\"> 2.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 872.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1050.00 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 700.0 </td>\n   <td style=\"text-align:right;\"> 5250.00 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 4200.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 668.00 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 24.0 </td>\n   <td style=\"text-align:right;\"> 3768.00 </td>\n   <td style=\"text-align:right;\"> 3375 </td>\n   <td style=\"text-align:right;\"> -11.0 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 3100.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1430.55 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 7106.1 </td>\n   <td style=\"text-align:right;\"> 3553.05 </td>\n   <td style=\"text-align:right;\"> 2100 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2122.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> SNB </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 69.50 </td>\n   <td style=\"text-align:right;\"> 5.0 </td>\n   <td style=\"text-align:right;\"> 49.9 </td>\n   <td style=\"text-align:right;\"> 249.50 </td>\n   <td style=\"text-align:right;\"> 125 </td>\n   <td style=\"text-align:right;\"> 2.2 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 180.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Dairy </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 770.00 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 661.0 </td>\n   <td style=\"text-align:right;\"> 4957.50 </td>\n   <td style=\"text-align:right;\"> 4000 </td>\n   <td style=\"text-align:right;\"> 7.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 4187.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Forest </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 623.50 </td>\n   <td style=\"text-align:right;\"> 157.0 </td>\n   <td style=\"text-align:right;\"> 23.0 </td>\n   <td style=\"text-align:right;\"> 3611.00 </td>\n   <td style=\"text-align:right;\"> 3250 </td>\n   <td style=\"text-align:right;\"> -10.5 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2987.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Crop </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1355.40 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n   <td style=\"text-align:right;\"> 6750.8 </td>\n   <td style=\"text-align:right;\"> 3375.40 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 2020.0 </td>\n  </tr>\n</tbody>\n</table></div>\n\n`````\n:::\n:::\n\n\n### Or visually...\nBelow are shown the income, costs, and net revenue per hectare for each farm type across the eight landuse capability classes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_data <- combined_data |> \n  pivot_longer(cols = c(\"Income\", \"Revenue\", \"Total costs\"))\n\nggplot(plot_data |> filter(name %in% c(\"Income\", \"Total costs\"))) +\n  geom_col(aes(x = LUC, y = value, group = name, fill = name),\n           position = \"dodge\") + \n  scale_fill_manual(values = c(\"#999999\", \"#ff6666\"), name = \"Income vs. Costs\") +\n  geom_point(data = plot_data |> filter(name == \"Revenue\"), \n            aes(x = LUC, y = value, shape = name), size = 7) +\n  scale_shape_manual(values = \"\\u2014\", name = \"\") + # \\u2014 is an em-dash\n  # The below more correct, but doesn't extend the lines to the full width of the plot\n  # geom_step(data = plot_data |> filter(name == \"Revenue\"), \n  #           aes(x = LUC, y = value, group = farm_type, colour = name), \n  #           direction = \"mid\", lwd = 0.65) +\n  # scale_colour_manual(values = c(\"black\"), name = \"\") +\n  xlab(\"Landuse Capability (LUC)\") +\n  ylab(\"Net Revenue, $ per ha.\") +\n  facet_wrap(~ farm_type) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](core-loop_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## The effect of interventions\nA range of possible interventions $I=\\{i_1,i_2,\\ldots i_n\\}$ may be undertaken by farmers, such as\n\n- Establish a wetland\n- Riparian planting\n- Clean races\n- Develop a farm plan\n- Join the emissions trading scheme\n- etc.\n\nThe currently adopted interventions on a particular farm we denote $A$ which will be a subset of the available interventions $I$. Not all interventions will make sense on each farm, so it might be more accurate to think of there being a number of intervention sets $I_F$ and on a particular farm of type $F$, the adopted interventions $A$ are some subset of $I_F$, with the potential new interventions to be considered in each time interval given by $I_F\\setminus A$, that is the possible interventions on this type of farm not yet adopted.\n\nFor each intervention $i_i$ there are associated impacts, in terms of added costs $\\Delta x_{iFL}$, and changes in yields $\\Delta q_{iFL}$ and emissions $\\Delta e_{iFL}$, where the $F$ and $L$ subscripts indicate the dependence of these impacts on farm type $F$ and landuse capability $L$. \n\nThe adopted interventions on a particular farm, change its yield to\n$$\nq = q_{FL}\\prod_{i\\in A} \\left( 1+\\Delta q_{iFL} \\right)\n$$\nits costs to\n$$\nx = x_{FL} + \\sum_{i\\in A} \\Delta x_{iFL}\n$$\nand its emissions to\n$$\ne = e_{FL}\\prod_{i\\in A} \\left(1+\\Delta e_{iFL}\\right)\n$$\nTogether these give us an overall net revenue for each hectare of landuse capability $L$ on a farm of type $F$ that has adopted a set of interventions $A$ \n$$\n{\nY_A = \\underbrace{ p_Fq_{FL}\\prod_{i\\in A} \\left( 1+\\Delta q_{iFL} \\right)}_{\\mathrm{total\\thinspace income}\\,Y} - \n\\underbrace{\n  \\underbrace{\\left( x_{FL} + \\sum_{i\\in A}\\Delta x_{iFL} \\right)}_{\\mathrm{running\\thinspace costs}} - \n  \\underbrace{te_{FL}\\prod_{i\\in A} \\left(1+\\Delta e_{iFL} \\right)}_{\\mathrm{carbon\\thinspace costs}}\n}_{\\mathrm{total\\thinspace costs}\\,X}\n}\n$$\nand the overall net revenue of any farm is given by summing this result across its constituent hectares. It is convenient to think of the net revenue as being the difference in the total income given by the first term in the above equation, and total costs given by the second and third terms.\n\n## Considering interventions\nThe current net revenue of a farm is determined as in the previous section. Call the current gross revenue and total cost components $Y_0$ and $X_0$, respectively. \n\nThen, for each intervention under consideration, i.e., each intervention $i_i\\in I_F\\setminus A$, the  new income and costs that would result $Y_i$ and $X_i$ are determined using the same equation, but with $A_i=A\\cup\\{i_i\\}$ augmented to include the new intervention.\n\nThis gives us percentage changes in each component\n\n$$\n\\begin{matrix}\n\\Delta Y_i & = & 100\\left(Y_i - Y_0\\right)/Y_0 \\\\\n\\Delta X_i & = & 100\\left(X_i - X_0\\right)/X_0\n\\end{matrix}\n$$\n\nIf we denote the baseline probability of adoption of each intervention on a particular farm type by $P_{iF}$ then we adjust this probability using the above two percentages according to\n\n$$\nP'_{iF}= \\left. 1 \\middle/ \\left(1+e^{\\ln\\frac{P_{iF}}{1-P_{iF}} + \\Delta Y_i - \\Delta X_i} \\right) \\right.\n$$\n\nThis puts the adoption probability of any intervention on a sigmoid curve, given by $p = 1/(1 + e^{-ax})$ where $x$ is some 'input' and $a$ is a rate of change in the probability in response to changes in the inputs. We haven't determined an appropriate setting for $a$, but intuitively it is a kind of measure of the 'elasticity' of farmer responses to changes in the combination of pressures driving their decision making. At low $a$ large pushes are needed to make much difference to the probability of a particular intervention; at high $a$ smaller pushes (perhaps even nudges!) might suffice.\n \n\n::: {.cell}\n\n```{.r .cell-code}\nsigmoid <- function(x, a = 1) {\n  1 / (1 + exp(-a * x))\n}\n\ndf <- expand_grid(`Pressure to change` = -50:50 / 10, \n                  a = c(0.25, 0.5, 1, 2, 5)) |>\n  mutate(Probability = sigmoid(`Pressure to change`, a))\n\nggplot(df) + \n  geom_line(aes(x = `Pressure to change`, y = Probability, group = a)) +\n  annotate(\"label\", x = c(4.25, 3.9, 3, 2, 1), \n           y = c(0.74, 0.87, 0.95, 0.975, 0.99),\n           label = paste0(\"a = \", unique(df$a)))\n```\n\n::: {.cell-output-display}\n![](core-loop_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nA positive calculated change in income $\\Delta Y_i$ pushes the farmer's probability of adoption of intervention $i$ higher (to the right), and any increase in total costs$\\Delta X_i$ pushes it lower (to the left). We start with initial probabilities of adoption in the `farmer-threshold-matrix.csv` file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprobabilities <- read.csv(\"data/market/farmer-threshold-matrix.csv\", \n                          header = T, row.names = 1)\nprobabilities |> \n  kable() |> \n  kable_styling(\"striped\", full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table quarto-disable-processing=\"true\" class=\"table table-striped\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:right;\"> SNB </th>\n   <th style=\"text-align:right;\"> Dairy </th>\n   <th style=\"text-align:right;\"> Forest </th>\n   <th style=\"text-align:right;\"> Crop </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Build_Wetland </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 0.3 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Riparian_Planting </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Clean_Races </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:right;\"> 0.70 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Farm_Plan </td>\n   <td style=\"text-align:right;\"> 0.7 </td>\n   <td style=\"text-align:right;\"> 0.85 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Join_ETS </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 0.9 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe exact slope and configuration of the sigmoid function relative to these probabilities (which are themselves arbitrary at present) remains to be determined, and may be tuneable to yield plausible outcomes. The general principle is that nudges increase the presure on farmers to change and will move them to the right on these curves, but that increases to costs will act against such pressures.\n\n## Adopting an intervention\nAll possible interventions are considered and assigned a probability $P'_{iF}$ on the above basis, giving a set of values $P=\\{P_{iF}\\}$. These are treated as 'weights' on a random draw of a single intervention. More favoured interventions are more likely to be drawn. \n\nIf a particular intervention is clearly preferable, say \n$$\nP=\\{0.01,0.01,0.5\\}\n$$\nthen it will almost certainly be chosen for further consideration. If all options are similar in their impacts, say\n$$\nP=\\{0.2,0.15,0.25\\}\n$$\nthen any of them stands a good chance of being picked.\n\nThe intervention picked in this way is then adopted with probability $P'_{iF}$. This means that\n$$\nP=\\{0.1,0.1,0.1\\}\n$$\nmight put forward any intervention for consideration but that chosen intervention is still unlikely to be adopted. On the other hand\n$$\nP=\\{0.5,0.5,0.5\\}\n$$\nwill give the selected intervention a 50% chance of adoption when it is considered.\n\nOnce an intervention is adopted, it will no longer be available in the next decision round and its impacts will be factored into calculation of the new $Y_0$ and $X_0$ income and costs, serving as a new baseline for the determination of $\\Delta Y_i$ and $\\Delta X_i$ scores.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}