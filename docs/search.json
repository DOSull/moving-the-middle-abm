[
  {
    "objectID": "sigmoid-testing/sigmoid-nudging.html",
    "href": "sigmoid-testing/sigmoid-nudging.html",
    "title": "MtM ABM documentation",
    "section": "",
    "text": "title: “Nudges and sigmoid function” output: pdf_document: default html_document: default date: “2023-06-27”\n\n\n\nlibrary(pracma)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\n\nnudge_threshold &lt;- Vectorize(\n  function(t, a, nudge) {\n    c &lt;- logit(t, a = a)\n    sigmoid(c + nudge, a = a)\n  }\n)\n\n\ndf &lt;- expand_grid(\n  `Baseline p` = c(0.01, 0.05, 0.1, 0.25, 0.5),\n  Responsiveness = c(0.2, 0.5, 1, 2, 3),\n  Nudge = -10:20 / 10\n) %&gt;%\n  as_tibble() %&gt;%\n  mutate(`Nudged p` = nudge_threshold(`Baseline p`, Responsiveness, Nudge))\n\n\nggplot(df) +\n  geom_line(aes(x = Nudge, y = `Nudged p`, group = `Baseline p`)) + \n  geom_hline(aes(yintercept = `Baseline p`), colour = \"red\", lty = \"dashed\") +\n  facet_grid(`Baseline p` ~ Responsiveness, labeller = label_both) + \n  theme_bw()"
  },
  {
    "objectID": "model-description/documents/01b-model-main-loop.html",
    "href": "model-description/documents/01b-model-main-loop.html",
    "title": "Model main loop",
    "section": "",
    "text": "The model steps through the sequence shown below each model ‘tick’.\nMore details of procedures in red are set out in documents linked from those boxes in the flow chart.\n\n\n\n\n\nflowchart TB\n  A((START))\n  B[&lt;span style='color:red;'&gt;Age farmers and&lt;br&gt;replace any that exit&lt;/span&gt;]\n  C[&lt;span style='color:red;'&gt;Update income, costs, and&lt;br&gt;profit of holdings and farms&lt;/span&gt;]\n  E[&lt;span style='color:red;'&gt;Farmer decision making&lt;/span&gt;]\n  T[Update map and plots]\n  Z((END))\n  A --&gt; B\n  B --&gt; C\n  C --&gt; E\n  E --&gt; T\n  T --&gt; Z\n  click B \"01c-farmer-aging-and-succession.html\" \"Click for details\"\n  click C \"02-calculation-of-farm-income.html\" \"Click for details\"\n  click E \"03-farmer-decisions-general.html\" \"Click for details\"\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-15\nPage split into model initialisation and model main loop.\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Model main loop"
    ]
  },
  {
    "objectID": "model-description/documents/01b-model-main-loop.html#model-main-loop",
    "href": "model-description/documents/01b-model-main-loop.html#model-main-loop",
    "title": "Model main loop",
    "section": "",
    "text": "The model steps through the sequence shown below each model ‘tick’.\nMore details of procedures in red are set out in documents linked from those boxes in the flow chart.\n\n\n\n\n\nflowchart TB\n  A((START))\n  B[&lt;span style='color:red;'&gt;Age farmers and&lt;br&gt;replace any that exit&lt;/span&gt;]\n  C[&lt;span style='color:red;'&gt;Update income, costs, and&lt;br&gt;profit of holdings and farms&lt;/span&gt;]\n  E[&lt;span style='color:red;'&gt;Farmer decision making&lt;/span&gt;]\n  T[Update map and plots]\n  Z((END))\n  A --&gt; B\n  B --&gt; C\n  C --&gt; E\n  E --&gt; T\n  T --&gt; Z\n  click B \"01c-farmer-aging-and-succession.html\" \"Click for details\"\n  click C \"02-calculation-of-farm-income.html\" \"Click for details\"\n  click E \"03-farmer-decisions-general.html\" \"Click for details\"\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-15\nPage split into model initialisation and model main loop.\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Model main loop"
    ]
  },
  {
    "objectID": "model-description/documents/04-farmer-decisions-land-use.html",
    "href": "model-description/documents/04-farmer-decisions-land-use.html",
    "title": "Farmer decisions about land use",
    "section": "",
    "text": "flowchart TB\n  A((START))\n  F{Any&lt;br&gt;loss-making&lt;br&gt;holdings?}\n  G[\"&lt;span style='font-family:monospace'&gt;options&lt;/span&gt; &larr; {}\"]\n  H{Farm&lt;br&gt;losing money&lt;br&gt;overall?}\n  I[Add possible&lt;br&gt;all of farm land use&lt;br&gt;changes to &lt;span style=\"font-family:monospace;\"&gt;options&lt;/span&gt;]\n  J[Add possible&lt;br&gt;per holding land use&lt;br&gt;changes to &lt;span style=\"font-family:monospace;\"&gt;options&lt;/span&gt;]\n  K[Choose among choices&lt;br&gt;in  &lt;span style=\"font-family:monospace;\"&gt;options&lt;/span&gt;]\n  L[&lt;span style='color:red;'&gt;Consider&lt;br&gt;interventions&lt;/span&gt;]\n  N{More&lt;br&gt;farmers?}\n  Z((END))\n  A --&gt; F\n  F --&gt;|Y| G\n  F --&gt;|N| L\n  subgraph \"Consider land use\"\n  G --&gt; H\n  H --&gt;|Y| I\n  H --&gt;|N| J\n  I --&gt; J\n  J --&gt; K\n  end\n  K --&gt; N\n  L --&gt; N\n  N --&gt;|Y| F\n  N --&gt;|N| Z\n  click L \"05-farmer-decisions-interventions.html\" \"Click for details\"\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Farmer decisions about land use"
    ]
  },
  {
    "objectID": "model-description/documents/01a-model-initialisation.html",
    "href": "model-description/documents/01a-model-initialisation.html",
    "title": "Model initialisation",
    "section": "",
    "text": "No further detail seems necessary on the initialisation processes beyond the sequence shown in the flow chart below.1\nflowchart TB\n  A((START))\n  B[Read land uses and&lt;br&gt;interventions from files]\n  C{Geography&lt;br&gt;from GIS&lt;br&gt;files?}\n  D[Setup LUC&lt;br&gt;on land]\n  E[Partition land&lt;br&gt;into farms]\n  F[Read LUC&lt;br&gt;from &lt;span style='font-family:monospace;'&gt;luc.asc&lt;/span&gt;]\n  G[Read farms&lt;br&gt;from &lt;span style='font-family:monospace;'&gt;parcels.shp&lt;/span&gt;]\n  H[Initialise farmers&lt;br&gt;one per farm]\n  I[Partition farms by LUC&lt;br&gt;into holdings]\n  J[Initialise market&lt;br&gt;settings from files]\n  K[Run one cycle]\n  L[Store settings&lt;br&gt;for rapid reset]\n  M((END))\n  A --&gt; B\n  B --&gt; C\n  C --&gt;|N| D\n  D --&gt; E\n  E --&gt; H\n  C --&gt;|Y| F\n  F --&gt; G\n  G --&gt; H\n  H --&gt; I\n  I --&gt; J\n  J --&gt; K\n  K --&gt; L\n  L --&gt; M",
    "crumbs": [
      "Documents",
      "Model initialisation"
    ]
  },
  {
    "objectID": "model-description/documents/01a-model-initialisation.html#footnotes",
    "href": "model-description/documents/01a-model-initialisation.html#footnotes",
    "title": "Model initialisation",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nIt is worth noting that there are some tricky sequencing issues in the setup which make the associated code a little ‘fragile’ with some obvious-seeming changes for ‘efficiency’ likely to break the model! (These are noted in code comments.)↩︎",
    "crumbs": [
      "Documents",
      "Model initialisation"
    ]
  },
  {
    "objectID": "model-description/documents/01c-farmer-aging-and-succession.html",
    "href": "model-description/documents/01c-farmer-aging-and-succession.html",
    "title": "Farmer aging and succession",
    "section": "",
    "text": "Farmers age by one year per model tick. Hence the model time scale is 1 year per tick, but this is subject to change. A 5 year model time step may be considered more appropriate.\nAfter aging, a farmer is tested for exiting the industry (or retiring or dying, or however we want to think about it). They exit with a probability given by \np_{\\mathrm{exit}} = \\left\\{\n  \\begin{array}{rcl}\n    \\frac{1}{91-\\mathrm{age}} & \\text{if age} &lt;  & 91 \\\\\n    1 & \\text{if age} \\geq & 91\n  \\end{array}\n\\right.\n This means that farmers are not guaranteed to exit until they are 90, reflecting the rather surprising number of old farmers in survey evidence",
    "crumbs": [
      "Documents",
      "Farmer aging and succession"
    ]
  },
  {
    "objectID": "model-description/documents/01c-farmer-aging-and-succession.html#farmer-aging",
    "href": "model-description/documents/01c-farmer-aging-and-succession.html#farmer-aging",
    "title": "Farmer aging and succession",
    "section": "",
    "text": "Farmers age by one year per model tick. Hence the model time scale is 1 year per tick, but this is subject to change. A 5 year model time step may be considered more appropriate.\nAfter aging, a farmer is tested for exiting the industry (or retiring or dying, or however we want to think about it). They exit with a probability given by \np_{\\mathrm{exit}} = \\left\\{\n  \\begin{array}{rcl}\n    \\frac{1}{91-\\mathrm{age}} & \\text{if age} &lt;  & 91 \\\\\n    1 & \\text{if age} \\geq & 91\n  \\end{array}\n\\right.\n This means that farmers are not guaranteed to exit until they are 90, reflecting the rather surprising number of old farmers in survey evidence",
    "crumbs": [
      "Documents",
      "Farmer aging and succession"
    ]
  },
  {
    "objectID": "model-description/documents/01c-farmer-aging-and-succession.html#age-of-farmers-at-model-initialisation",
    "href": "model-description/documents/01c-farmer-aging-and-succession.html#age-of-farmers-at-model-initialisation",
    "title": "Farmer aging and succession",
    "section": "Age of farmers at model initialisation",
    "text": "Age of farmers at model initialisation\nThe age of farmers at model initialisation is drawn from a :beta-binomial distribution, with n=70, \\alpha=5, and \\beta=4, and ages then offset by adding 20 (so that 20 is the youngest possible age). An example distribution for 250 farmers is shown below, with the red line showing the associated probability density function.\n\n\n\n\n\n\n\n\n\nThis distribution has been roughly matched to survey evidence of farmer ages (it has not been fitted, just matched approximately by eye).",
    "crumbs": [
      "Documents",
      "Farmer aging and succession"
    ]
  },
  {
    "objectID": "model-description/documents/01c-farmer-aging-and-succession.html#age-of-new-farmers",
    "href": "model-description/documents/01c-farmer-aging-and-succession.html#age-of-new-farmers",
    "title": "Farmer aging and succession",
    "section": "Age of new farmers",
    "text": "Age of new farmers\nIncoming farmer ages are also drawn from a beta-binomial distribution with n=45, \\alpha=4, \\alpha=2.\n\n\n\n\n\n\n\n\n\nThis distribution might appear to skew older than the model age initialisation, but note that the range of values tops out at 65 years as shown in the direct comparison of the probability density functions below.\n\n\n\n\n\n\n\n\n\nIn any case, this paramterisatiopn appears to keep the farmer age distribution fairly stable over time.\nMore detailed fitting and analysis of these (hard-coded) parameter settings around farmer ages is desirable.\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-15\nInitial post.",
    "crumbs": [
      "Documents",
      "Farmer aging and succession"
    ]
  },
  {
    "objectID": "model-description/index.html",
    "href": "model-description/index.html",
    "title": "Moving the Middle ABM description",
    "section": "",
    "text": "This document provides a high-level overview of the operation of the agent-based model under development for the Moving the Middle project. The model code is available for download at this repository.\nAlthough the model aims to be ‘simple’, that is a relative term. The model is only as complicated as it needs to be, which turns out to be relatively complicated. In short, there are a lot of moving parts.\nAs a way to manage this complexity I have organised the description into a set of linked documents as listed below.\n\n\n\n\n\n\n\n\n\n\nTitle\n\n\n\n\n\n\nOverall model structure\n\n\n\n\nModel initialisation\n\n\n\n\nModel main loop\n\n\n\n\nFarmer aging and succession\n\n\n\n\nCalculation of farm income\n\n\n\n\nFarmer decision making: general\n\n\n\n\nFarmer decisions about land use\n\n\n\n\nFarmer decisions about management interventions\n\n\n\n\nPossible extensions of the model\n\n\n\n\n\nNo matching items",
    "crumbs": [
      "Moving the Middle ABM documentation"
    ]
  },
  {
    "objectID": "model-description/documents/06-possible-extensions.html",
    "href": "model-description/documents/06-possible-extensions.html",
    "title": "Possible extensions of the model",
    "section": "",
    "text": "Clarify model scales both temporal (1 year or 5 years per tick?) and spatial (1 ha per cell?)\nInclusion of landuse in spatial data files.\nMultiple values of the sigmoid-slope attribute for different push and pull factors on decision making.\nMake farmer dispositions matter. Probably a case of extending the farmer thresholds input file to cross-tab by disposition.\nActivate local and industry network effects.\nTune farmer age distributions by fitting to data.\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Possible extensions of the model"
    ]
  },
  {
    "objectID": "model-description/documents/02-calculation-of-farm-income.html",
    "href": "model-description/documents/02-calculation-of-farm-income.html",
    "title": "Calculation of farm income",
    "section": "",
    "text": "The baseline profit Z of each hectare of a farm is given by\nZ=Y-X\nwhere Y is gross income, and X is total costs. These are in turn given by\n\n\\begin{array}{rcl}\nY &=& pq \\\\\nX &=& x+te\n\\end{array}\n\nwhere\n\np is the price obtained per unit,\nq is the quantity produced per hectare,\nx is the cost per hectare to operate,\ne is the greenhouse gas emissions per hectare, and\nt is the tax on each unit of emissions.\n\nEach of these parameters may depend on the farm type F (one of Crops, Dairy, Forestry, or Sheep/Beef) and the land use capability (LUC), L, such that the full calculation of profit for each hectare of a farm is \nZ_{FL} = p_Fq_{FL} - x_{FL} - te_{FL}\n and total farm profit is obtaining by summing this quantity across all hectares of the farm (which may be of varying landuse capability L).\n\n\nThe parameter values are stored in a number of CSV files which are read in by the model at start up.\n\n\np_F and the greenhouse gas tax (i.e. carbon price), t, are in the prices.csv file:\n\n\nCode\nprices &lt;- read.csv(str_glue(\"{base_dir}prices.csv\"), \n                   header = T, row.names = 1) |&gt; \n  slice(1:2) # only rows 1 & 2 relevant\nprices |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F)\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    Price_Commodity \n    5 \n    7.5 \n    157 \n    0.5 \n  \n  \n    Price_GhG \n    25 \n    25.0 \n    25 \n    25.0 \n  \n\n\n\n\n\n\n\n\nYields by farm type and landuse capability, q_{FL}, are in the commodity-yields.csv file:\n\n\nCode\nyields &lt;- read.csv(str_glue(\"{base_dir}commodity-yields.csv\"), \n                   header = T, row.names = 1)\nyields |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    LUC1_Mean \n    768.505660 \n    1503.0000 \n    30.0 \n    9667.000 \n  \n  \n    LUC1_SD \n    153.701132 \n    300.6000 \n    6.0 \n    1933.400 \n  \n  \n    LUC2_Mean \n    581.247332 \n    1283.0000 \n    29.0 \n    9183.650 \n  \n  \n    LUC2_SD \n    116.249466 \n    256.6000 \n    5.8 \n    1836.730 \n  \n  \n    LUC3_Mean \n    372.371287 \n    1174.3000 \n    28.0 \n    8724.468 \n  \n  \n    LUC3_SD \n    74.474257 \n    234.8600 \n    5.6 \n    1744.893 \n  \n  \n    LUC4_Mean \n    332.178378 \n    923.3900 \n    27.0 \n    8288.244 \n  \n  \n    LUC4_SD \n    66.435676 \n    184.6780 \n    5.4 \n    1657.649 \n  \n  \n    LUC5_Mean \n    259.480336 \n    877.7308 \n    26.0 \n    7873.832 \n  \n  \n    LUC5_SD \n    51.896067 \n    175.5462 \n    5.2 \n    1574.766 \n  \n  \n    LUC6_Mean \n    207.386971 \n    845.7812 \n    25.0 \n    7480.140 \n  \n  \n    LUC6_SD \n    41.477394 \n    169.1562 \n    5.0 \n    1496.028 \n  \n  \n    LUC7_Mean \n    193.188428 \n    700.0000 \n    24.0 \n    7106.133 \n  \n  \n    LUC7_SD \n    38.637686 \n    140.0000 \n    4.8 \n    1421.227 \n  \n  \n    LUC8_Mean \n    49.945208 \n    661.0000 \n    23.0 \n    6750.827 \n  \n  \n    LUC8_SD \n    9.989042 \n    132.2000 \n    4.6 \n    1350.165 \n  \n\n\n\n\n\n\n\n\nBase costs per ha. by farm type and landuse capability, x_{FL}, are in the input-costs.csv file:\n\n\nCode\ncosts &lt;- read.csv(str_glue(\"{base_dir}input-costs.csv\"), \n                   header = T, row.names = 1)\ncosts |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    LUC1_Mean \n    3500 \n    9500 \n    4000 \n    3000 \n  \n  \n    LUC1_SD \n    700 \n    1900 \n    800 \n    600 \n  \n  \n    LUC2_Mean \n    2650 \n    8050 \n    4000 \n    2850 \n  \n  \n    LUC2_SD \n    530 \n    1610 \n    800 \n    570 \n  \n  \n    LUC3_Mean \n    1625 \n    7350 \n    3850 \n    2675 \n  \n  \n    LUC3_SD \n    325 \n    1470 \n    770 \n    535 \n  \n  \n    LUC4_Mean \n    1450 \n    5500 \n    3700 \n    2500 \n  \n  \n    LUC4_SD \n    290 \n    1100 \n    740 \n    500 \n  \n  \n    LUC5_Mean \n    1110 \n    5200 \n    3550 \n    2400 \n  \n  \n    LUC5_SD \n    222 \n    1040 \n    710 \n    480 \n  \n  \n    LUC6_Mean \n    875 \n    5000 \n    3500 \n    2200 \n  \n  \n    LUC6_SD \n    175 \n    1000 \n    700 \n    440 \n  \n  \n    LUC7_Mean \n    810 \n    4000 \n    3375 \n    2100 \n  \n  \n    LUC7_SD \n    162 \n    800 \n    675 \n    420 \n  \n  \n    LUC8_Mean \n    125 \n    4000 \n    3250 \n    2000 \n  \n  \n    LUC8_SD \n    25 \n    800 \n    650 \n    400 \n  \n\n\n\n\n\n\n\n\nEmissions per ha. by farm type and landuse capability, e_{FL}, are in the ghg-emissions.csv file:\n\n\nCode\nemissions &lt;- read.csv(str_glue(\"{base_dir}ghg-emissions.csv\"), \n                      header = T, row.names = 1)\nemissions |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    LUC1_Mean \n    4.000 \n    11.00 \n    -15.000000 \n    1.2000000 \n  \n  \n    LUC1_SD \n    1.200 \n    3.30 \n    4.500000 \n    0.3600000 \n  \n  \n    LUC2_Mean \n    3.750 \n    10.50 \n    -14.250000 \n    1.1400000 \n  \n  \n    LUC2_SD \n    1.125 \n    3.15 \n    4.275000 \n    0.3420000 \n  \n  \n    LUC3_Mean \n    3.500 \n    10.00 \n    -13.537500 \n    1.0830000 \n  \n  \n    LUC3_SD \n    1.050 \n    3.00 \n    4.061250 \n    0.3249000 \n  \n  \n    LUC4_Mean \n    3.250 \n    9.50 \n    -12.860625 \n    1.0288500 \n  \n  \n    LUC4_SD \n    0.975 \n    2.85 \n    3.858188 \n    0.3086550 \n  \n  \n    LUC5_Mean \n    3.000 \n    9.00 \n    -12.217594 \n    0.9774075 \n  \n  \n    LUC5_SD \n    0.900 \n    2.70 \n    3.665278 \n    0.2932223 \n  \n  \n    LUC6_Mean \n    2.750 \n    8.50 \n    -11.606714 \n    0.9285371 \n  \n  \n    LUC6_SD \n    0.825 \n    2.55 \n    3.482014 \n    0.2785611 \n  \n  \n    LUC7_Mean \n    2.500 \n    8.00 \n    -11.026378 \n    0.8821103 \n  \n  \n    LUC7_SD \n    0.750 \n    2.40 \n    3.307914 \n    0.2646331 \n  \n  \n    LUC8_Mean \n    2.250 \n    7.50 \n    -10.475059 \n    0.8380048 \n  \n  \n    LUC8_SD \n    0.675 \n    2.25 \n    3.142518 \n    0.2514014 \n  \n\n\n\n\n\n \nNote that all of yields, base costs, and emissions are stored as a mean and a standard deviation, and that individual hectare sites will see these numbers vary every model time period by drawing from a normal distribution.\nWe can use these data to show the profit, gross income, and total costs for each farm type across different landuse capability classes. We’ll throw away the standard deviations for simplicity and consider only mean outcomes.\n\n\nCode\nprices &lt;- prices |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  rename(price = Price_Commodity, carbon_tax = Price_GhG) |&gt;\n  slice(rep(row_number(), 8)) |&gt;\n  mutate(LUC = rep(1:8, each = 4))\n\nyields &lt;- yields |&gt;\n  slice(seq(1, 15, 2)) |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  pivot_longer(-1) |&gt;\n  mutate(LUC = rep(1:8, 4), yield = round(value, 1)) |&gt;\n  select(farm_type, LUC, yield)\n\ncosts &lt;- costs |&gt;\n  slice(seq(1, 15, 2)) |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  pivot_longer(-1) |&gt;\n  mutate(LUC = rep(1:8, 4), costs = round(value, 1)) |&gt;\n  select(farm_type, LUC, costs)\n\nemissions &lt;- emissions |&gt; \n  slice(seq(1, 15, 2)) |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  pivot_longer(-1) |&gt;\n  mutate(LUC = rep(1:8, 4), emissions = round(value, 1)) |&gt;\n  select(farm_type, LUC, emissions)\n\ncombined_data &lt;- prices |&gt;\n  left_join(yields) |&gt;\n  left_join(costs) |&gt;\n  left_join(emissions) |&gt;\n  mutate(gross_income = price * yield, # LUC = as.factor(LUC),\n         total_costs = costs + carbon_tax * emissions, base_costs = costs,\n         profit = gross_income - total_costs) |&gt;\n  select(farm_type, LUC, profit, price, yield, gross_income, base_costs,\n         emissions, carbon_tax, total_costs) |&gt;\n  rename(Profit = profit, `Gross income` = gross_income, `Total costs` = total_costs)\n\ncombined_data |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n    farm_type \n    LUC \n    Profit \n    price \n    yield \n    Gross income \n    base_costs \n    emissions \n    carbon_tax \n    Total costs \n  \n \n\n  \n    SNB \n    1 \n    242.50 \n    5.0 \n    768.5 \n    3842.50 \n    3500 \n    4.0 \n    25 \n    3600.0 \n  \n  \n    Dairy \n    1 \n    1497.50 \n    7.5 \n    1503.0 \n    11272.50 \n    9500 \n    11.0 \n    25 \n    9775.0 \n  \n  \n    Forest \n    1 \n    1085.00 \n    157.0 \n    30.0 \n    4710.00 \n    4000 \n    -15.0 \n    25 \n    3625.0 \n  \n  \n    Crop \n    1 \n    1803.50 \n    0.5 \n    9667.0 \n    4833.50 \n    3000 \n    1.2 \n    25 \n    3030.0 \n  \n  \n    SNB \n    2 \n    161.00 \n    5.0 \n    581.2 \n    2906.00 \n    2650 \n    3.8 \n    25 \n    2745.0 \n  \n  \n    Dairy \n    2 \n    1310.00 \n    7.5 \n    1283.0 \n    9622.50 \n    8050 \n    10.5 \n    25 \n    8312.5 \n  \n  \n    Forest \n    2 \n    908.00 \n    157.0 \n    29.0 \n    4553.00 \n    4000 \n    -14.2 \n    25 \n    3645.0 \n  \n  \n    Crop \n    2 \n    1714.30 \n    0.5 \n    9183.6 \n    4591.80 \n    2850 \n    1.1 \n    25 \n    2877.5 \n  \n  \n    SNB \n    3 \n    149.50 \n    5.0 \n    372.4 \n    1862.00 \n    1625 \n    3.5 \n    25 \n    1712.5 \n  \n  \n    Dairy \n    3 \n    1207.25 \n    7.5 \n    1174.3 \n    8807.25 \n    7350 \n    10.0 \n    25 \n    7600.0 \n  \n  \n    Forest \n    3 \n    883.50 \n    157.0 \n    28.0 \n    4396.00 \n    3850 \n    -13.5 \n    25 \n    3512.5 \n  \n  \n    Crop \n    3 \n    1659.75 \n    0.5 \n    8724.5 \n    4362.25 \n    2675 \n    1.1 \n    25 \n    2702.5 \n  \n  \n    SNB \n    4 \n    131.00 \n    5.0 \n    332.2 \n    1661.00 \n    1450 \n    3.2 \n    25 \n    1530.0 \n  \n  \n    Dairy \n    4 \n    1188.00 \n    7.5 \n    923.4 \n    6925.50 \n    5500 \n    9.5 \n    25 \n    5737.5 \n  \n  \n    Forest \n    4 \n    861.50 \n    157.0 \n    27.0 \n    4239.00 \n    3700 \n    -12.9 \n    25 \n    3377.5 \n  \n  \n    Crop \n    4 \n    1619.10 \n    0.5 \n    8288.2 \n    4144.10 \n    2500 \n    1.0 \n    25 \n    2525.0 \n  \n  \n    SNB \n    5 \n    112.50 \n    5.0 \n    259.5 \n    1297.50 \n    1110 \n    3.0 \n    25 \n    1185.0 \n  \n  \n    Dairy \n    5 \n    1157.75 \n    7.5 \n    877.7 \n    6582.75 \n    5200 \n    9.0 \n    25 \n    5425.0 \n  \n  \n    Forest \n    5 \n    837.00 \n    157.0 \n    26.0 \n    4082.00 \n    3550 \n    -12.2 \n    25 \n    3245.0 \n  \n  \n    Crop \n    5 \n    1511.90 \n    0.5 \n    7873.8 \n    3936.90 \n    2400 \n    1.0 \n    25 \n    2425.0 \n  \n  \n    SNB \n    6 \n    92.00 \n    5.0 \n    207.4 \n    1037.00 \n    875 \n    2.8 \n    25 \n    945.0 \n  \n  \n    Dairy \n    6 \n    1131.00 \n    7.5 \n    845.8 \n    6343.50 \n    5000 \n    8.5 \n    25 \n    5212.5 \n  \n  \n    Forest \n    6 \n    715.00 \n    157.0 \n    25.0 \n    3925.00 \n    3500 \n    -11.6 \n    25 \n    3210.0 \n  \n  \n    Crop \n    6 \n    1517.55 \n    0.5 \n    7480.1 \n    3740.05 \n    2200 \n    0.9 \n    25 \n    2222.5 \n  \n  \n    SNB \n    7 \n    93.50 \n    5.0 \n    193.2 \n    966.00 \n    810 \n    2.5 \n    25 \n    872.5 \n  \n  \n    Dairy \n    7 \n    1050.00 \n    7.5 \n    700.0 \n    5250.00 \n    4000 \n    8.0 \n    25 \n    4200.0 \n  \n  \n    Forest \n    7 \n    668.00 \n    157.0 \n    24.0 \n    3768.00 \n    3375 \n    -11.0 \n    25 \n    3100.0 \n  \n  \n    Crop \n    7 \n    1430.55 \n    0.5 \n    7106.1 \n    3553.05 \n    2100 \n    0.9 \n    25 \n    2122.5 \n  \n  \n    SNB \n    8 \n    69.50 \n    5.0 \n    49.9 \n    249.50 \n    125 \n    2.2 \n    25 \n    180.0 \n  \n  \n    Dairy \n    8 \n    770.00 \n    7.5 \n    661.0 \n    4957.50 \n    4000 \n    7.5 \n    25 \n    4187.5 \n  \n  \n    Forest \n    8 \n    623.50 \n    157.0 \n    23.0 \n    3611.00 \n    3250 \n    -10.5 \n    25 \n    2987.5 \n  \n  \n    Crop \n    8 \n    1355.40 \n    0.5 \n    6750.8 \n    3375.40 \n    2000 \n    0.8 \n    25 \n    2020.0 \n  \n\n\n\n\n\n\n\n\n\nBelow are shown the income, costs, and net revenue per hectare for each farm type across the eight landuse capability classes. These are crude estimates dating back to the ARLUNZ model1 and will be updated in due course.\n\n\nCode\nplot_data &lt;- combined_data |&gt; \n  pivot_longer(cols = c(\"Gross income\", \"Profit\", \"Total costs\"))\n\nggplot(plot_data |&gt; filter(name %in% c(\"Gross income\", \"Total costs\"))) +\n  geom_col(aes(x = as.factor(LUC), y = value, group = name, fill = name),\n           position = \"dodge\") + \n  scale_fill_manual(values = c(\"#999999\", \"#ff6666\"), name = \"Income vs. Costs\") +\n  geom_point(data = plot_data |&gt; filter(name == \"Profit\"), \n            aes(x = LUC, y = value, shape = name), size = 7) +\n  scale_shape_manual(values = \"\\u2014\", name = \"\") + # \\u2014 is an em-dash\n  # The below more correct, but doesn't extend the lines to the full width of the plot\n  # geom_step(data = plot_data |&gt; filter(name == \"Profit\"), \n  #           aes(x = LUC, y = value, group = farm_type, colour = name), \n  #           direction = \"mid\", lwd = 0.65) +\n  # scale_colour_manual(values = c(\"black\"), name = \"\") +\n  xlab(\"Landuse Capability (LUC)\") +\n  ylab(\"Profit, $ per ha.\") +\n  facet_wrap(~ farm_type) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Calculation of farm income"
    ]
  },
  {
    "objectID": "model-description/documents/02-calculation-of-farm-income.html#baseline-income-equation-for-farms",
    "href": "model-description/documents/02-calculation-of-farm-income.html#baseline-income-equation-for-farms",
    "title": "Calculation of farm income",
    "section": "",
    "text": "The baseline profit Z of each hectare of a farm is given by\nZ=Y-X\nwhere Y is gross income, and X is total costs. These are in turn given by\n\n\\begin{array}{rcl}\nY &=& pq \\\\\nX &=& x+te\n\\end{array}\n\nwhere\n\np is the price obtained per unit,\nq is the quantity produced per hectare,\nx is the cost per hectare to operate,\ne is the greenhouse gas emissions per hectare, and\nt is the tax on each unit of emissions.\n\nEach of these parameters may depend on the farm type F (one of Crops, Dairy, Forestry, or Sheep/Beef) and the land use capability (LUC), L, such that the full calculation of profit for each hectare of a farm is \nZ_{FL} = p_Fq_{FL} - x_{FL} - te_{FL}\n and total farm profit is obtaining by summing this quantity across all hectares of the farm (which may be of varying landuse capability L).\n\n\nThe parameter values are stored in a number of CSV files which are read in by the model at start up.\n\n\np_F and the greenhouse gas tax (i.e. carbon price), t, are in the prices.csv file:\n\n\nCode\nprices &lt;- read.csv(str_glue(\"{base_dir}prices.csv\"), \n                   header = T, row.names = 1) |&gt; \n  slice(1:2) # only rows 1 & 2 relevant\nprices |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F)\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    Price_Commodity \n    5 \n    7.5 \n    157 \n    0.5 \n  \n  \n    Price_GhG \n    25 \n    25.0 \n    25 \n    25.0 \n  \n\n\n\n\n\n\n\n\nYields by farm type and landuse capability, q_{FL}, are in the commodity-yields.csv file:\n\n\nCode\nyields &lt;- read.csv(str_glue(\"{base_dir}commodity-yields.csv\"), \n                   header = T, row.names = 1)\nyields |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    LUC1_Mean \n    768.505660 \n    1503.0000 \n    30.0 \n    9667.000 \n  \n  \n    LUC1_SD \n    153.701132 \n    300.6000 \n    6.0 \n    1933.400 \n  \n  \n    LUC2_Mean \n    581.247332 \n    1283.0000 \n    29.0 \n    9183.650 \n  \n  \n    LUC2_SD \n    116.249466 \n    256.6000 \n    5.8 \n    1836.730 \n  \n  \n    LUC3_Mean \n    372.371287 \n    1174.3000 \n    28.0 \n    8724.468 \n  \n  \n    LUC3_SD \n    74.474257 \n    234.8600 \n    5.6 \n    1744.893 \n  \n  \n    LUC4_Mean \n    332.178378 \n    923.3900 \n    27.0 \n    8288.244 \n  \n  \n    LUC4_SD \n    66.435676 \n    184.6780 \n    5.4 \n    1657.649 \n  \n  \n    LUC5_Mean \n    259.480336 \n    877.7308 \n    26.0 \n    7873.832 \n  \n  \n    LUC5_SD \n    51.896067 \n    175.5462 \n    5.2 \n    1574.766 \n  \n  \n    LUC6_Mean \n    207.386971 \n    845.7812 \n    25.0 \n    7480.140 \n  \n  \n    LUC6_SD \n    41.477394 \n    169.1562 \n    5.0 \n    1496.028 \n  \n  \n    LUC7_Mean \n    193.188428 \n    700.0000 \n    24.0 \n    7106.133 \n  \n  \n    LUC7_SD \n    38.637686 \n    140.0000 \n    4.8 \n    1421.227 \n  \n  \n    LUC8_Mean \n    49.945208 \n    661.0000 \n    23.0 \n    6750.827 \n  \n  \n    LUC8_SD \n    9.989042 \n    132.2000 \n    4.6 \n    1350.165 \n  \n\n\n\n\n\n\n\n\nBase costs per ha. by farm type and landuse capability, x_{FL}, are in the input-costs.csv file:\n\n\nCode\ncosts &lt;- read.csv(str_glue(\"{base_dir}input-costs.csv\"), \n                   header = T, row.names = 1)\ncosts |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    LUC1_Mean \n    3500 \n    9500 \n    4000 \n    3000 \n  \n  \n    LUC1_SD \n    700 \n    1900 \n    800 \n    600 \n  \n  \n    LUC2_Mean \n    2650 \n    8050 \n    4000 \n    2850 \n  \n  \n    LUC2_SD \n    530 \n    1610 \n    800 \n    570 \n  \n  \n    LUC3_Mean \n    1625 \n    7350 \n    3850 \n    2675 \n  \n  \n    LUC3_SD \n    325 \n    1470 \n    770 \n    535 \n  \n  \n    LUC4_Mean \n    1450 \n    5500 \n    3700 \n    2500 \n  \n  \n    LUC4_SD \n    290 \n    1100 \n    740 \n    500 \n  \n  \n    LUC5_Mean \n    1110 \n    5200 \n    3550 \n    2400 \n  \n  \n    LUC5_SD \n    222 \n    1040 \n    710 \n    480 \n  \n  \n    LUC6_Mean \n    875 \n    5000 \n    3500 \n    2200 \n  \n  \n    LUC6_SD \n    175 \n    1000 \n    700 \n    440 \n  \n  \n    LUC7_Mean \n    810 \n    4000 \n    3375 \n    2100 \n  \n  \n    LUC7_SD \n    162 \n    800 \n    675 \n    420 \n  \n  \n    LUC8_Mean \n    125 \n    4000 \n    3250 \n    2000 \n  \n  \n    LUC8_SD \n    25 \n    800 \n    650 \n    400 \n  \n\n\n\n\n\n\n\n\nEmissions per ha. by farm type and landuse capability, e_{FL}, are in the ghg-emissions.csv file:\n\n\nCode\nemissions &lt;- read.csv(str_glue(\"{base_dir}ghg-emissions.csv\"), \n                      header = T, row.names = 1)\nemissions |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    LUC1_Mean \n    4.000 \n    11.00 \n    -15.000000 \n    1.2000000 \n  \n  \n    LUC1_SD \n    1.200 \n    3.30 \n    4.500000 \n    0.3600000 \n  \n  \n    LUC2_Mean \n    3.750 \n    10.50 \n    -14.250000 \n    1.1400000 \n  \n  \n    LUC2_SD \n    1.125 \n    3.15 \n    4.275000 \n    0.3420000 \n  \n  \n    LUC3_Mean \n    3.500 \n    10.00 \n    -13.537500 \n    1.0830000 \n  \n  \n    LUC3_SD \n    1.050 \n    3.00 \n    4.061250 \n    0.3249000 \n  \n  \n    LUC4_Mean \n    3.250 \n    9.50 \n    -12.860625 \n    1.0288500 \n  \n  \n    LUC4_SD \n    0.975 \n    2.85 \n    3.858188 \n    0.3086550 \n  \n  \n    LUC5_Mean \n    3.000 \n    9.00 \n    -12.217594 \n    0.9774075 \n  \n  \n    LUC5_SD \n    0.900 \n    2.70 \n    3.665278 \n    0.2932223 \n  \n  \n    LUC6_Mean \n    2.750 \n    8.50 \n    -11.606714 \n    0.9285371 \n  \n  \n    LUC6_SD \n    0.825 \n    2.55 \n    3.482014 \n    0.2785611 \n  \n  \n    LUC7_Mean \n    2.500 \n    8.00 \n    -11.026378 \n    0.8821103 \n  \n  \n    LUC7_SD \n    0.750 \n    2.40 \n    3.307914 \n    0.2646331 \n  \n  \n    LUC8_Mean \n    2.250 \n    7.50 \n    -10.475059 \n    0.8380048 \n  \n  \n    LUC8_SD \n    0.675 \n    2.25 \n    3.142518 \n    0.2514014 \n  \n\n\n\n\n\n \nNote that all of yields, base costs, and emissions are stored as a mean and a standard deviation, and that individual hectare sites will see these numbers vary every model time period by drawing from a normal distribution.\nWe can use these data to show the profit, gross income, and total costs for each farm type across different landuse capability classes. We’ll throw away the standard deviations for simplicity and consider only mean outcomes.\n\n\nCode\nprices &lt;- prices |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  rename(price = Price_Commodity, carbon_tax = Price_GhG) |&gt;\n  slice(rep(row_number(), 8)) |&gt;\n  mutate(LUC = rep(1:8, each = 4))\n\nyields &lt;- yields |&gt;\n  slice(seq(1, 15, 2)) |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  pivot_longer(-1) |&gt;\n  mutate(LUC = rep(1:8, 4), yield = round(value, 1)) |&gt;\n  select(farm_type, LUC, yield)\n\ncosts &lt;- costs |&gt;\n  slice(seq(1, 15, 2)) |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  pivot_longer(-1) |&gt;\n  mutate(LUC = rep(1:8, 4), costs = round(value, 1)) |&gt;\n  select(farm_type, LUC, costs)\n\nemissions &lt;- emissions |&gt; \n  slice(seq(1, 15, 2)) |&gt; \n  t() |&gt; \n  as.data.frame() |&gt; \n  tibble::rownames_to_column(\"farm_type\") |&gt;\n  pivot_longer(-1) |&gt;\n  mutate(LUC = rep(1:8, 4), emissions = round(value, 1)) |&gt;\n  select(farm_type, LUC, emissions)\n\ncombined_data &lt;- prices |&gt;\n  left_join(yields) |&gt;\n  left_join(costs) |&gt;\n  left_join(emissions) |&gt;\n  mutate(gross_income = price * yield, # LUC = as.factor(LUC),\n         total_costs = costs + carbon_tax * emissions, base_costs = costs,\n         profit = gross_income - total_costs) |&gt;\n  select(farm_type, LUC, profit, price, yield, gross_income, base_costs,\n         emissions, carbon_tax, total_costs) |&gt;\n  rename(Profit = profit, `Gross income` = gross_income, `Total costs` = total_costs)\n\ncombined_data |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n    farm_type \n    LUC \n    Profit \n    price \n    yield \n    Gross income \n    base_costs \n    emissions \n    carbon_tax \n    Total costs \n  \n \n\n  \n    SNB \n    1 \n    242.50 \n    5.0 \n    768.5 \n    3842.50 \n    3500 \n    4.0 \n    25 \n    3600.0 \n  \n  \n    Dairy \n    1 \n    1497.50 \n    7.5 \n    1503.0 \n    11272.50 \n    9500 \n    11.0 \n    25 \n    9775.0 \n  \n  \n    Forest \n    1 \n    1085.00 \n    157.0 \n    30.0 \n    4710.00 \n    4000 \n    -15.0 \n    25 \n    3625.0 \n  \n  \n    Crop \n    1 \n    1803.50 \n    0.5 \n    9667.0 \n    4833.50 \n    3000 \n    1.2 \n    25 \n    3030.0 \n  \n  \n    SNB \n    2 \n    161.00 \n    5.0 \n    581.2 \n    2906.00 \n    2650 \n    3.8 \n    25 \n    2745.0 \n  \n  \n    Dairy \n    2 \n    1310.00 \n    7.5 \n    1283.0 \n    9622.50 \n    8050 \n    10.5 \n    25 \n    8312.5 \n  \n  \n    Forest \n    2 \n    908.00 \n    157.0 \n    29.0 \n    4553.00 \n    4000 \n    -14.2 \n    25 \n    3645.0 \n  \n  \n    Crop \n    2 \n    1714.30 \n    0.5 \n    9183.6 \n    4591.80 \n    2850 \n    1.1 \n    25 \n    2877.5 \n  \n  \n    SNB \n    3 \n    149.50 \n    5.0 \n    372.4 \n    1862.00 \n    1625 \n    3.5 \n    25 \n    1712.5 \n  \n  \n    Dairy \n    3 \n    1207.25 \n    7.5 \n    1174.3 \n    8807.25 \n    7350 \n    10.0 \n    25 \n    7600.0 \n  \n  \n    Forest \n    3 \n    883.50 \n    157.0 \n    28.0 \n    4396.00 \n    3850 \n    -13.5 \n    25 \n    3512.5 \n  \n  \n    Crop \n    3 \n    1659.75 \n    0.5 \n    8724.5 \n    4362.25 \n    2675 \n    1.1 \n    25 \n    2702.5 \n  \n  \n    SNB \n    4 \n    131.00 \n    5.0 \n    332.2 \n    1661.00 \n    1450 \n    3.2 \n    25 \n    1530.0 \n  \n  \n    Dairy \n    4 \n    1188.00 \n    7.5 \n    923.4 \n    6925.50 \n    5500 \n    9.5 \n    25 \n    5737.5 \n  \n  \n    Forest \n    4 \n    861.50 \n    157.0 \n    27.0 \n    4239.00 \n    3700 \n    -12.9 \n    25 \n    3377.5 \n  \n  \n    Crop \n    4 \n    1619.10 \n    0.5 \n    8288.2 \n    4144.10 \n    2500 \n    1.0 \n    25 \n    2525.0 \n  \n  \n    SNB \n    5 \n    112.50 \n    5.0 \n    259.5 \n    1297.50 \n    1110 \n    3.0 \n    25 \n    1185.0 \n  \n  \n    Dairy \n    5 \n    1157.75 \n    7.5 \n    877.7 \n    6582.75 \n    5200 \n    9.0 \n    25 \n    5425.0 \n  \n  \n    Forest \n    5 \n    837.00 \n    157.0 \n    26.0 \n    4082.00 \n    3550 \n    -12.2 \n    25 \n    3245.0 \n  \n  \n    Crop \n    5 \n    1511.90 \n    0.5 \n    7873.8 \n    3936.90 \n    2400 \n    1.0 \n    25 \n    2425.0 \n  \n  \n    SNB \n    6 \n    92.00 \n    5.0 \n    207.4 \n    1037.00 \n    875 \n    2.8 \n    25 \n    945.0 \n  \n  \n    Dairy \n    6 \n    1131.00 \n    7.5 \n    845.8 \n    6343.50 \n    5000 \n    8.5 \n    25 \n    5212.5 \n  \n  \n    Forest \n    6 \n    715.00 \n    157.0 \n    25.0 \n    3925.00 \n    3500 \n    -11.6 \n    25 \n    3210.0 \n  \n  \n    Crop \n    6 \n    1517.55 \n    0.5 \n    7480.1 \n    3740.05 \n    2200 \n    0.9 \n    25 \n    2222.5 \n  \n  \n    SNB \n    7 \n    93.50 \n    5.0 \n    193.2 \n    966.00 \n    810 \n    2.5 \n    25 \n    872.5 \n  \n  \n    Dairy \n    7 \n    1050.00 \n    7.5 \n    700.0 \n    5250.00 \n    4000 \n    8.0 \n    25 \n    4200.0 \n  \n  \n    Forest \n    7 \n    668.00 \n    157.0 \n    24.0 \n    3768.00 \n    3375 \n    -11.0 \n    25 \n    3100.0 \n  \n  \n    Crop \n    7 \n    1430.55 \n    0.5 \n    7106.1 \n    3553.05 \n    2100 \n    0.9 \n    25 \n    2122.5 \n  \n  \n    SNB \n    8 \n    69.50 \n    5.0 \n    49.9 \n    249.50 \n    125 \n    2.2 \n    25 \n    180.0 \n  \n  \n    Dairy \n    8 \n    770.00 \n    7.5 \n    661.0 \n    4957.50 \n    4000 \n    7.5 \n    25 \n    4187.5 \n  \n  \n    Forest \n    8 \n    623.50 \n    157.0 \n    23.0 \n    3611.00 \n    3250 \n    -10.5 \n    25 \n    2987.5 \n  \n  \n    Crop \n    8 \n    1355.40 \n    0.5 \n    6750.8 \n    3375.40 \n    2000 \n    0.8 \n    25 \n    2020.0 \n  \n\n\n\n\n\n\n\n\n\nBelow are shown the income, costs, and net revenue per hectare for each farm type across the eight landuse capability classes. These are crude estimates dating back to the ARLUNZ model1 and will be updated in due course.\n\n\nCode\nplot_data &lt;- combined_data |&gt; \n  pivot_longer(cols = c(\"Gross income\", \"Profit\", \"Total costs\"))\n\nggplot(plot_data |&gt; filter(name %in% c(\"Gross income\", \"Total costs\"))) +\n  geom_col(aes(x = as.factor(LUC), y = value, group = name, fill = name),\n           position = \"dodge\") + \n  scale_fill_manual(values = c(\"#999999\", \"#ff6666\"), name = \"Income vs. Costs\") +\n  geom_point(data = plot_data |&gt; filter(name == \"Profit\"), \n            aes(x = LUC, y = value, shape = name), size = 7) +\n  scale_shape_manual(values = \"\\u2014\", name = \"\") + # \\u2014 is an em-dash\n  # The below more correct, but doesn't extend the lines to the full width of the plot\n  # geom_step(data = plot_data |&gt; filter(name == \"Profit\"), \n  #           aes(x = LUC, y = value, group = farm_type, colour = name), \n  #           direction = \"mid\", lwd = 0.65) +\n  # scale_colour_manual(values = c(\"black\"), name = \"\") +\n  xlab(\"Landuse Capability (LUC)\") +\n  ylab(\"Profit, $ per ha.\") +\n  facet_wrap(~ farm_type) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Calculation of farm income"
    ]
  },
  {
    "objectID": "model-description/documents/02-calculation-of-farm-income.html#footnotes",
    "href": "model-description/documents/02-calculation-of-farm-income.html#footnotes",
    "title": "Calculation of farm income",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nSee: Morgan FJ and AJ Daigneault. 2015. Estimating Impacts of Climate Change Policy on Land Use: An Agent-Based Modelling Approach. PLOS ONE 10(5): e0127317.↩︎",
    "crumbs": [
      "Documents",
      "Calculation of farm income"
    ]
  },
  {
    "objectID": "model-description/documents/05-farmer-decisions-interventions.html",
    "href": "model-description/documents/05-farmer-decisions-interventions.html",
    "title": "Farmer decisions about management interventions",
    "section": "",
    "text": "flowchart TB\n  A((START))\n  F{Any&lt;br&gt;loss-making&lt;br&gt;holdings?}\n  G[&lt;span style='color:red;'&gt;Consider land&lt;br&gt;use change&lt;/span&gt;]\n  L[Compile list of&lt;br&gt;possible interventions&lt;br&gt;per holding]\n  M[Choose and possibly&lt;br&gt;implement interventions]\n  N{More&lt;br&gt;farmers?}\n  Z((END))\n  A --&gt; F\n  F --&gt;|Y| G\n  G --&gt; N\n  F --&gt;|N| L\n  subgraph \"Consider interventions\"\n  L --&gt; M\n  end\n  M --&gt; N\n  N --&gt;|Y| F\n  N --&gt;|N| Z\n  click G \"04-farmer-decisions-land-use.html\" \"Click for details\"",
    "crumbs": [
      "Documents",
      "Farmer decisions about management interventions"
    ]
  },
  {
    "objectID": "model-description/documents/05-farmer-decisions-interventions.html#the-effect-of-interventions",
    "href": "model-description/documents/05-farmer-decisions-interventions.html#the-effect-of-interventions",
    "title": "Farmer decisions about management interventions",
    "section": "The effect of interventions",
    "text": "The effect of interventions\nA range of possible interventions I=\\{i_1,i_2,\\ldots i_n\\} may be undertaken by farmers, such as\n\nEstablish a wetland\nRiparian planting\nClean races\nDevelop a farm plan\nJoin the emissions trading scheme\netc.\n\nThe currently adopted interventions on a particular farm we denote A which will be a subset of the available interventions I. Not all interventions will make sense on each farm, so it might be more accurate to think of there being a number of intervention sets I_F and on a particular farm of type F, the adopted interventions A are some subset of I_F, with the potential new interventions to be considered in each time interval given by I_F\\setminus A, that is the possible interventions on this type of farm not yet adopted.\nFor each intervention i_i there are associated impacts, in terms of added costs \\Delta x_{iFL}, and changes in yields \\Delta q_{iFL} and emissions \\Delta e_{iFL}, where the F and L subscripts indicate the dependence of these impacts on farm type F and landuse capability L. The impacts of various interventions are stored in the intervention-impacts.csv file:\n\n\nCode\ninterventions &lt;- read.csv(str_glue(\"{base_dir}intervention-impacts.csv\"), \n                          header = T)\ninterventions |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F) |&gt;\n  scroll_box(height = \"250px\")\n\n\n\n \n  \n    Intervention \n    Impact \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    Build_Wetland \n    costs \n    25.00 \n    68.00 \n    NA \n    34.00 \n  \n  \n    Build_Wetland \n    yields \n    -0.20 \n    -0.02 \n    NA \n    -0.10 \n  \n  \n    Build_Wetland \n    emissions \n    -0.10 \n    -0.05 \n    NA \n    -0.05 \n  \n  \n    Riparian_Planting \n    costs \n    26.00 \n    71.00 \n    NA \n    11.00 \n  \n  \n    Riparian_Planting \n    yields \n    -0.20 \n    -0.02 \n    NA \n    -0.01 \n  \n  \n    Riparian_Planting \n    emissions \n    -0.10 \n    -0.03 \n    NA \n    -0.04 \n  \n  \n    Clean_Races \n    costs \n    NA \n    75.00 \n    NA \n    NA \n  \n  \n    Clean_Races \n    yields \n    NA \n    0.00 \n    NA \n    NA \n  \n  \n    Clean_Races \n    emissions \n    NA \n    -0.01 \n    NA \n    NA \n  \n  \n    Farm_Plan \n    costs \n    6.00 \n    34.00 \n    NA \n    NA \n  \n  \n    Farm_Plan \n    yields \n    -0.05 \n    -0.01 \n    NA \n    NA \n  \n  \n    Farm_Plan \n    emissions \n    -0.06 \n    -0.05 \n    NA \n    NA \n  \n  \n    Join_ETS \n    costs \n    1.00 \n    25.00 \n    50.0 \n    100.00 \n  \n  \n    Join_ETS \n    yields \n    -0.25 \n    -0.25 \n    0.1 \n    -0.10 \n  \n  \n    Join_ETS \n    emissions \n    -0.50 \n    -0.50 \n    0.1 \n    -0.25 \n  \n\n\n\n\n\n \nThe adopted interventions on a particular farm, change its yield to \nq = q_{FL}\\prod_{i\\in A} \\left( 1+\\Delta q_{iFL} \\right)\n its total costs to \nx = x_{FL} + \\sum_{i\\in A} \\Delta x_{iFL}\n and its emissions to \ne = e_{FL}\\prod_{i\\in A} \\left(1+\\Delta e_{iFL}\\right)\n Together these give us an overall profit for each hectare of landuse capability L on a farm of type F that has adopted a set of interventions A \n{\nZ_A = \\underbrace{ p_Fq_{FL}\\prod_{i\\in A} \\left( 1+\\Delta q_{iFL} \\right)}_{\\mathrm{gross\\thinspace income}\\,Y} -\n\\underbrace{\n  \\underbrace{\\left( x_{FL} + \\sum_{i\\in A}\\Delta x_{iFL} \\right)}_{\\mathrm{base\\thinspace costs}} -\n  \\underbrace{te_{FL}\\prod_{i\\in A} \\left(1+\\Delta e_{iFL} \\right)}_{\\mathrm{carbon\\thinspace costs}}\n}_{\\mathrm{total\\thinspace costs}\\,X}\n}\n and the overall profit of any farm is given by summing this result across its constituent hectares. It is convenient to think of the profit as being the difference in the gross income given by the first term in the above equation, and total costs given by the second and third terms.",
    "crumbs": [
      "Documents",
      "Farmer decisions about management interventions"
    ]
  },
  {
    "objectID": "model-description/documents/05-farmer-decisions-interventions.html#considering-interventions",
    "href": "model-description/documents/05-farmer-decisions-interventions.html#considering-interventions",
    "title": "Farmer decisions about management interventions",
    "section": "Considering interventions",
    "text": "Considering interventions\nThe current profit of a farm is determined as in the previous section. Call the current profit, gross income, and total cost components \\tilde{Y}_0 and \\tilde{X}_0, respectively.\nThen, for each intervention under consideration, i.e., each intervention i_i\\in I_F\\setminus A, the new expected gross income, and total costs that would result \\bar{Y}_i and \\bar{X}_i are determined using the same equation, but with A_i=A\\cup\\{i_i\\} augmented to include the new intervention, and no variance in outcomes taken into consideration, i.e., using only the mean yield, costs, and emissions settings (the \\tilde{Y}_0 and \\tilde{X}_0 values will reflect that variance in the most recent year’s results).\nThis gives us relative change in each component, which for a particular component we define as \n\\Delta x = \\left\\{\n\\begin{array}{rl}\n  \\left. 2\\left(|x_1 - x_0|\\right) \\middle/ \\left( |x_1| + |x_0| \\right) \\right. & \\text{if $x_1&gt;x_0$} \\\\\n  \\left. -2\\left(|x_1 - x_0|\\right) \\middle/ \\left( |x_1| + |x_0| \\right) \\right. & \\text{if $x_1&lt;x_0$} \\\\\n  0 & \\text{if $x_0=x_1=0$}\n\\end{array}\\right.\n\nNOTE: this formulation works if both quantities are of the same sign (both positive, or both negative) but produces meaningless results if the before and after quantities are of different sign, and so the approach outlined here cannot be extended to farm profits, which can be positive or negative.\nValues for \\Delta Y_i and \\Delta X_i are calculated in this way and used to determine adjusted relative probabilities of adoption of each possible intervention. If we denote the baseline probability of adoption of each intervention on a particular farm type by P_{iF} then we adjust this probability using the \\Delta values according to \n{\n  P'_{iF}= \\left. 1 \\middle/\n  \\left(1+e^{-a\\left[ \\ln\\frac{P_{iF}}{1-P_{iF}} + \\Delta Y_i - \\Delta X_i \\right]} \\right) \\right.\n}\n\nThis puts the adoption probability of any intervention on a sigmoid curve, given by P = 1/(1 + e^{-ax}) where x is some ‘pressure for change’ and a is a rate of change in the probability in response to changes in that pressure. We haven’t determined an appropriate setting for a, but intuitively it is a kind of measure of the ‘elasticity’ of farmer responses to changes in the combination of pressures driving their decision making. At low a large pushes are needed to make much difference to the probability of a particular intervention; at high a smaller pushes (perhaps even nudges!) might suffice. In general an adoption probability will be at its most elastic when it is around 0.5 with substantial pressure required to make a low probability event more likely, or to make an already probable outcome near certain.\n\n\nCode\nsigmoid &lt;- function(x, a = 1) {\n  1 / (1 + exp(-a * x))\n}\n\ndf &lt;- expand_grid(`Pressure to change` = -50:50 / 10, \n                  a = c(0.25, 0.5, 1, 2, 5)) |&gt;\n  mutate(Probability = sigmoid(`Pressure to change`, a))\n\nggplot(df) + \n  geom_line(aes(x = `Pressure to change`, y = Probability, group = a)) +\n  annotate(\"label\", x = c(4.25, 3.9, 3, 2, 1), \n           y = c(0.74, 0.87, 0.95, 0.975, 0.99),\n           label = paste0(\"a = \", unique(df$a)))\n\n\n\n\n\n\n\n\n\nA positive calculated change in income \\Delta Y_i pushes the farmer’s probability of adoption of intervention i higher (to the right), and any increase in total costs \\Delta X_i pushes it lower (to the left). We start with initial probabilities of adoption in the farmer-threshold-matrix.csv file:\n\n\nCode\nprobabilities &lt;- read.csv(str_glue(\"{base_dir}farmer-threshold-matrix.csv\"), \n                          header = T, row.names = 1)\nprobabilities |&gt; \n  kable() |&gt; \n  kable_styling(\"striped\", full_width = F)\n\n\n\n \n  \n     \n    SNB \n    Dairy \n    Forest \n    Crop \n  \n \n\n  \n    Build_Wetland \n    0.7 \n    0.75 \n    0.3 \n    0.5 \n  \n  \n    Riparian_Planting \n    0.7 \n    0.75 \n    0.2 \n    0.4 \n  \n  \n    Clean_Races \n    0.2 \n    0.70 \n    0.0 \n    0.0 \n  \n  \n    Farm_Plan \n    0.7 \n    0.85 \n    0.4 \n    0.6 \n  \n  \n    Join_ETS \n    0.1 \n    0.10 \n    0.9 \n    0.5 \n  \n\n\n\n\n\nThe exact slope and configuration of the sigmoid function relative to these probabilities (which are themselves arbitrary at present) remains to be determined, and may be tunable to yield plausible outcomes. The general principle is that nudges increase the pressure on farmers to change and will move them to the right on these curves, but that increases to costs will act against such pressures.\nNOTE: We have to consider if this approach is sensible given that it may mean that farmers are less likely to adopt interventions after a good year than they after a bad year…",
    "crumbs": [
      "Documents",
      "Farmer decisions about management interventions"
    ]
  },
  {
    "objectID": "model-description/documents/05-farmer-decisions-interventions.html#adopting-an-intervention",
    "href": "model-description/documents/05-farmer-decisions-interventions.html#adopting-an-intervention",
    "title": "Farmer decisions about management interventions",
    "section": "Adopting an intervention",
    "text": "Adopting an intervention\nAll possible interventions are considered and assigned a probability P'_{iF} on the above basis, giving a set of values P=\\{P_{iF}\\}. These are treated as ‘weights’ on a random draw of a single intervention. More favoured interventions are more likely to be drawn.\nIf a particular intervention is clearly preferable, say \nP=\\{0.01,0.01,0.5\\}\n then it will almost certainly be chosen for further consideration. If all options are similar in their impacts, say \nP=\\{0.2,0.15,0.25\\}\n then any of them stands a good chance of being picked.\nThe intervention picked in this way is then adopted with probability P'_{iF}. This means that \nP=\\{0.1,0.1,0.1\\}\n might put forward any intervention for consideration but that chosen intervention is still unlikely to be adopted. On the other hand \nP=\\{0.5,0.5,0.5\\}\n will give the selected intervention a 50% chance of adoption when it is considered.\nOnce an intervention is adopted, it will no longer be available in the next decision round and its impacts will be factored into calculation of the new Y_0 and X_0 income and costs, serving as a new baseline for the determination of \\Delta Y_i and \\Delta X_i scores.",
    "crumbs": [
      "Documents",
      "Farmer decisions about management interventions"
    ]
  },
  {
    "objectID": "model-description/documents/05-farmer-decisions-interventions.html#a-note-on-how-model-calculations-are-performed",
    "href": "model-description/documents/05-farmer-decisions-interventions.html#a-note-on-how-model-calculations-are-performed",
    "title": "Farmer decisions about management interventions",
    "section": "A note on how model calculations are performed",
    "text": "A note on how model calculations are performed\nIn the model, calculations are performed using matrices.\nAll three of yields, costs, and emissions, are stored as a pair of matrices\n\n\\begin{array}{rcl}\n\\overline{\\mathbf{M}} & = & \\left[\\overline{\\circ}_{LF}\\right]\\\\\n\\widetilde{\\mathbf{M}} & = & \\left[\\widetilde{\\circ}_{LF}\\right]\n\\end{array}\n\nfor the mean and standard deviations respectively, where \\circ stands in for one of q, x, or e. Row entries record the values associate with a given landuse capability level, and column entries the values assoicated with a given farm type.\nPrices are stored as a prices vector, \\mathbf{p}=\\left[p_i\\right], and the carbon tax as a scalar value, t, since it is fixed tax irrespective of farm type.\nIgnoring for now the effect of adopted interventions, this gives us a matrix form of the income calculation for a farm\n\nY = \\mathbf{1}\\left[\\mathbf{L}\\odot N\\left(\\overline{\\mathbf{Q}},\\frac{\\widetilde{\\mathbf{Q}}}{\\sqrt{n_{LF}}}\\right)\\right]\\mathbf{p}\n\nwhere \\mathbf{L} is a landuse capability-landuse profile matrix for the farm with row and column entries n_{LF} giving the numbers of patches in each landuse capability and landuse category on that farm, and \\odot denotes element-wise multiplication of two matrices. A similar matrix equation is applicable to the costs for a farm.\nThe most important thing to note here is the reduction in the standard deviation of the normal distribution from which yields q are drawn by the factor \\sqrt{n_{LF}}. This allows only one random number draw for each landuse capability-landuse combination on a farm, rather than for every patch on the farm individually, and allows more rapid calculation of farms income, costs, and emissions. The penalty is that all patches in the model of the same landuse capability-landuse combination have the same mean yield, input cost, emissions every model tick, and that every landuse capability-landuse combination on each farm sees the same deviation from the mean applied each tick.\nCalculation of additional costs resulting from adoption of various interventions can also be formulated as a matrix calculation, using a row-matrix of adopted interventions where 1 denotes adoption and 0 non-adoption of each intervention.\nA more involved matrix formulation is required for the impact of adoption of interventions on emissions and yields because these are combined multiplicatively. The model code is the best guide to the details in this case. The code has been written to ensure that the equations detailed in the section on the effect of interventions has been followed.\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2024-07-28\nCorrection in equation summarising full calculation of profit. Added note to consider the nudge calculation’s possible bias favouring changes after bad years.\n\n\n2024-07-05\nCorrected relative change from a percentage to a proportion.\n\n\n2024-07-04\nAdded detail on calculation of relative change noting that profit can’t be handled this way because it is \\pm and relative change is meaningless for such variables.\n\n\n2024-07-03\nAdded bar chart of farm income/costs estimates.\n\n\n2024-07-02\nInitial post.",
    "crumbs": [
      "Documents",
      "Farmer decisions about management interventions"
    ]
  },
  {
    "objectID": "model-description/documents/03-farmer-decisions-general.html",
    "href": "model-description/documents/03-farmer-decisions-general.html",
    "title": "Farmer decision making: general",
    "section": "",
    "text": "flowchart TB\n  A((START))\n  B[Age farmers and&lt;br&gt;replace any that exit]\n  C[Update income, costs, and&lt;br&gt;profit of holdings and farms]\n  E[/For each&lt;br&gt;farmer.../]\n  F{Loss-making&lt;br&gt;holdings?}\n  G[&lt;span style='color:red;'&gt;Consider land&lt;br&gt;use change&lt;/span&gt;]\n  L[&lt;span style='color:red;'&gt;Consider&lt;br&gt;interventions&lt;/span&gt;]\n  N[/More&lt;br&gt;farmers?/]\n  Z((END))\n  A --&gt; B\n  B --&gt; C\n  C --&gt; E\n  E --&gt; F\n  F --&gt;|Y| G\n  F --&gt;|N| L\n  G --&gt; N\n  L --&gt; N\n  N --&gt;|Y| E\n  N --&gt;|N| Z\n  click G \"04-farmer-decisions-land-use.html\" \"Click for details\"\n  click L \"05-farmer-decisions-interventions.html\" \"Click for details\"\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2024-12-17\nInitial post.",
    "crumbs": [
      "Documents",
      "Farmer decision making: general"
    ]
  },
  {
    "objectID": "model-description/documents/03-farmer-decisions-general.html#top-level-farmer-decision-flowchart",
    "href": "model-description/documents/03-farmer-decisions-general.html#top-level-farmer-decision-flowchart",
    "title": "Farmer decision making: general",
    "section": "",
    "text": "flowchart TB\n  A((START))\n  B[Age farmers and&lt;br&gt;replace any that exit]\n  C[Update income, costs, and&lt;br&gt;profit of holdings and farms]\n  E[/For each&lt;br&gt;farmer.../]\n  F{Loss-making&lt;br&gt;holdings?}\n  G[&lt;span style='color:red;'&gt;Consider land&lt;br&gt;use change&lt;/span&gt;]\n  L[&lt;span style='color:red;'&gt;Consider&lt;br&gt;interventions&lt;/span&gt;]\n  N[/More&lt;br&gt;farmers?/]\n  Z((END))\n  A --&gt; B\n  B --&gt; C\n  C --&gt; E\n  E --&gt; F\n  F --&gt;|Y| G\n  F --&gt;|N| L\n  G --&gt; N\n  L --&gt; N\n  N --&gt;|Y| E\n  N --&gt;|N| Z\n  click G \"04-farmer-decisions-land-use.html\" \"Click for details\"\n  click L \"05-farmer-decisions-interventions.html\" \"Click for details\"\n\n\n\n\n\n\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2024-12-17\nInitial post.",
    "crumbs": [
      "Documents",
      "Farmer decision making: general"
    ]
  },
  {
    "objectID": "model-description/documents/00-overall-model-structure.html",
    "href": "model-description/documents/00-overall-model-structure.html",
    "title": "Overall model structure",
    "section": "",
    "text": "At time of writing (mid-Feb 2025) the model GUI appears as below (click on the image for a closer look):\n\n\n\nControls on the left-hand side are primarily starting and running the model and controlling display of visual elements.\n\n\n\nThe map area shows LUC (more intense colours are better land) and land use according to the following key:\n\nGreens Forest\nBlues Dairy\nOranges Sheep and beef (SNB)\nPurples Crops\n\nFarms are delineated in black and their current profit is shown by a circle scaled by the level of profit. If ‘in the black’ the circle is coloured to match dominant land use on the farm. If the farm is losing money (‘in the red’) the circle is coloured red.\nHoldings are delineated in grey and shown by squares scaled and coloured in the same way as farms.\n\n\n\nThe column of controls immediately to the right of the map area mostly controls model initialisation, in particularly allowing for initialisation from controlled random number seeds to allow for repeatability of results and exploration of the details of any findings. Two important settings are controlled by ‘sliders’:\n\nsigmoid-slope controls the rate of change of probabilities of adoption of intervention in response to push and pull factors. This is uncalibrated at present. A potential extension of the model would allow different levels of this control for different ‘nudge’ or market effects.\ncarbon-price the model carbon price (which impacts calculation of farm costs)\n\n\n\n\nThe column of controls on the right of the model provides some tracking plots (farmer ages, overall land on which different interventions have been adopted, and overall land in different land uses), and also some high level controls as follows:\n\nconsider-landuse-change-on-succession: If On when a farmer is succeeded by a new entrant the new farmer considers a change in (all of farm) land use\nprioritise-forestry-set-aside: If On when a holding is unprofitable only forestry is considered as new land use; other land uses are considered if this option is Off\napply-severity-of-losses`: If On losses occurring across more of the farm (by area) make whole of farm conversion of land use more likely\napply-suitability`: If On suitability of LUC of holdings is taken into account when land use change is undertaken; If **Off* land use change disregards LUC\nregion: Specifies data/spatial subfolder of GIS input files\nscenario: Specifies data/market subfolder of market input files",
    "crumbs": [
      "Documents",
      "Overall model structure"
    ]
  },
  {
    "objectID": "model-description/documents/00-overall-model-structure.html#the-model-interface",
    "href": "model-description/documents/00-overall-model-structure.html#the-model-interface",
    "title": "Overall model structure",
    "section": "",
    "text": "At time of writing (mid-Feb 2025) the model GUI appears as below (click on the image for a closer look):\n\n\n\nControls on the left-hand side are primarily starting and running the model and controlling display of visual elements.\n\n\n\nThe map area shows LUC (more intense colours are better land) and land use according to the following key:\n\nGreens Forest\nBlues Dairy\nOranges Sheep and beef (SNB)\nPurples Crops\n\nFarms are delineated in black and their current profit is shown by a circle scaled by the level of profit. If ‘in the black’ the circle is coloured to match dominant land use on the farm. If the farm is losing money (‘in the red’) the circle is coloured red.\nHoldings are delineated in grey and shown by squares scaled and coloured in the same way as farms.\n\n\n\nThe column of controls immediately to the right of the map area mostly controls model initialisation, in particularly allowing for initialisation from controlled random number seeds to allow for repeatability of results and exploration of the details of any findings. Two important settings are controlled by ‘sliders’:\n\nsigmoid-slope controls the rate of change of probabilities of adoption of intervention in response to push and pull factors. This is uncalibrated at present. A potential extension of the model would allow different levels of this control for different ‘nudge’ or market effects.\ncarbon-price the model carbon price (which impacts calculation of farm costs)\n\n\n\n\nThe column of controls on the right of the model provides some tracking plots (farmer ages, overall land on which different interventions have been adopted, and overall land in different land uses), and also some high level controls as follows:\n\nconsider-landuse-change-on-succession: If On when a farmer is succeeded by a new entrant the new farmer considers a change in (all of farm) land use\nprioritise-forestry-set-aside: If On when a holding is unprofitable only forestry is considered as new land use; other land uses are considered if this option is Off\napply-severity-of-losses`: If On losses occurring across more of the farm (by area) make whole of farm conversion of land use more likely\napply-suitability`: If On suitability of LUC of holdings is taken into account when land use change is undertaken; If **Off* land use change disregards LUC\nregion: Specifies data/spatial subfolder of GIS input files\nscenario: Specifies data/market subfolder of market input files",
    "crumbs": [
      "Documents",
      "Overall model structure"
    ]
  },
  {
    "objectID": "model-description/documents/00-overall-model-structure.html#model-elements",
    "href": "model-description/documents/00-overall-model-structure.html#model-elements",
    "title": "Overall model structure",
    "section": "Model elements",
    "text": "Model elements\nClearly, there is a lot going on here. The easiest way to get a handle on it is through the main model elements and their attributes and behaviours.\n\nLand use\nEach unit of land in the model, and the aggregations into holdings or farms has a land use, which is one of \"Crop\", \"Dairy\", \"Forest\", or \"SNB\". This classification could be made more detailed, although some work would be required on visualization aspects of the model to accommodate the change. Note: Applied to grid cells representing the land in the model, land use is the landuse attribute. Applied to farmers, farms, or holdings it is farm-type.1 For holdings the two will always match exactly (all cells in a holding will be the same land use), but for farmers and farms not all associated cells need be in the same land use.\n\n\nManagement interventions\nA list of potential management interventions, such as e.g., \"Build_Wetland\", \"Clean_Races\", \"Farm_Plan\", \"Join_ETS\", or \"Riparian_Planting\". These have associated impacts on costs, yields and emissions as set out in the intervention-impacts.csv file.\n\n\nThe land\nThe land is represented by a square grid of cells (in NetLogo terminology ‘patches’). Each grid cell represents a notional 1 hectare, although the model’s spatial and temporal scales remain a little fuzzy at present. Each cell ‘knows’ its owning farmer and the holding and farm of which it is a part, although this information at the grid cell level is used mostly during model initialiasation. Each cell also has a landuse attribute which is one of the land uses represented, and a luc-code, an integer between 1 and 8 (inclusive).\n\n\nFarmers\nFarmers are the only decision-making agents in the model even as other model elements (farms and holdings) are coded as ‘agents’ (everything in NetLogo is an agent2).\nFarmers have the following attributes:\n\nfarm-type: one of the land uses in the model, i.e. one of \"Crop\", \"Dairy\", \"Forest\", or \"SNB\"\nmy-farm: this farmer’s farm\nmy-holdings: this farmer’s holdings\nthe-land: a list of grid cells that compose the farm\nage: age in years. Affects likelihood of farmer leaving and being succeeded by a new farmer.\nsuccession-stage: how many ‘new farmers’ or ‘which generation’ of farmer this one is on this farm. We don’t spawn new farmers on succession, we just change their settings and increment this attribute\ndisposition: one of \"for-profit\", \"pro-social\", or \"pro-environmental\". Not currently used.\nindustry-links and local-links: other farmers connected to this one, that might influence their decisions. The model machinery to enable this is present but not currently used.\n\nKey actions run by farmers include:\n\nage-and-succeed-farmer: each model tick farmers age by one year, and with probability \\frac{1}{91-\\mathrm{age}} exit the industry and are replaced by a new farmer that may be of different disposition, a different age (not necessarily younger, but probably), and if any holdings are currently loss-making will consider all of farm land use change.\nconsider-farm-type-change and consider-holdings-farm-type-change: as detailed in Farmer decisions about land use farmers may decide to change the land use of a whole farm, or change the land use of individual holdings.\nmake-farm-type-changes: if a decision is taken to change land use on a farm or any of its holdings the farmer coordinates necessary updates to the model state.\nconsider-management-changes and make-management-changes: consider possible management interventions for adoption and implement them (or not) as detailed in Farmer decisions about management interventions.\n\n\n\nFarms\nFarms don’t do much of anything since holdings were added to the model. This is reflected in the fact that their only attributes are the self-explanatory the-land, farm-type, and my-farmer. A potential extension of the model (part implemented) records the losses-record of a farm and this impacts the willingness of farmer’s to consider land use change, so that an all-of-farm change in land use would become more likely as losses persist over time.\n\n\nHoldings\nHoldings are subfarm level units at which management interventions and land use changes are implemented.\nHoldings have the following attributes:\n\nfarm-type: one of the land uses in the model, i.e. one of \"Crop\", \"Dairy\", \"Forest\", or \"SNB\"\nmy-farmer: the farmer who owns this holding\nmy-farm: the farm of which this holding is a part\nthe-land: a list of grid cells that compose the holding\nlanduse-luc-profile: a cross tabulation of the number of grid cells (i.e., hectares) of land in the holding by land use and LUC. In the current implementation since holdings are defined by land use and LUC only one entry in the table will be non-zero! However, as detailed in Calculation of farm income this allows for more complex holding structures—most likely with a range of LUC across a holding. A farmer can sum these matrices to get a picture of the overall composition of the farm.\ncurrent-profit, current-income, and current-costs: profit, income, and costs of the holding as detailed in Calculation of farm income.\nmy-mgmt-interventions: a list of boolean flags indicating which management interventions have been adopted on this holding.\navail-mgmt-interventions: a list of boolean flags indicating which management interventions remain available to this holding for possible adoptions.\n\nKey actions run by holdings (at the behest of farmers!) are:\n\nholding-change-farm-type and implement-intervention: bookkeeping functions to pass changes in land use down to grid cells and update the lists of adopted and available interventions.\nget-intervention-score: scores interventions under consideration based on impact on costs and income as detailed in Farmer decisions about management interventions.\nget-holding-income and get-holding-costs: calculate holding income and costs as detailed in Calculation of farm income\nget-cost-after-intervention, get-yield-after-intervention, and get-emissions-after-intervention: calculates what the income or yield or emissions of the holding would be if a specified intervention were to be implemented as part of the decision making process around management interventions, as detailed in Farmer decisions about management interventions.",
    "crumbs": [
      "Documents",
      "Overall model structure"
    ]
  },
  {
    "objectID": "model-description/documents/00-overall-model-structure.html#organisation-of-model-files",
    "href": "model-description/documents/00-overall-model-structure.html#organisation-of-model-files",
    "title": "Overall model structure",
    "section": "Organisation of model files",
    "text": "Organisation of model files\n\nCode\nTo make managing model source code a little easier the code is broken into a main .nlogo file and a number of NetLogo source .nls files. Unfortunately the built in IDE for NetLogo is rather primitive, so this breakdown is not perfect, but it at least keeps the size of each source file manageable (a few hundred lines at most), where a monolithic flat file would be 2000+ lines. The files are as follows:\n\n\n\n\n\n\n\nFilename\nPurpose\n\n\n\n\nabm-working.nlogo\nDefinition of globals, setup and main model loop, model reset code\n\n\nmtm-read-files.nls\nReading of market setting files into tables and conversion to matrices\n\n\nmtm-geography.nls\nSetup of model geography, whether from GIS files or random\n\n\nmtm-farmer.nls\nInitialisation and maintenance of farmer agents, primarily procedures for choosing among options for land use change / management interventions\n\n\nmtm-farm.nls\nInitialisation and maintenance of farm agents\n\n\nmtm-holding.nls\nInitialisation and maintence of holding agents, primarily calculation of income and costs\n\n\nmtm-plots.nls\nPlotting of some model statistics for interactive exploration\n\n\nmtm-render.nls\nVisual rendering of model state\n\n\n\nIn addition the files list-utils.nls, distribution-utils.nls (both from my netlogo-utils project), and mtm-utils.nls collect together a large number of utility functions of general use to all the other model components.\n\n\nData\nA key idea underpinning model development was to avoid hard coding dozens, or even hundreds of settings into the model code. To that end a data folder in the same directory as the model source code has subfolders market and spatial themselves with subfolders containing model input files that can specify scenarios whether catchment-based (the spatial folder) or market-based (the market folder).\n\nMarket\nEach ../data/market/&lt;scenario-name&gt; subfolder contains a collection of files that configure aspects of the market, which together form a scenario.\n\n\n\n\n\n\n\nFilename\nPurpose\n\n\n\n\nfarmer-threshold-matrix.csv\nBaseline probabilities of adoption by farmers of available management interventions by land use\n\n\nintervention-impacts.csv\nImpact on yields, costs, and emissions per ha. by management intervention and land use\n\n\nconversion-probabilities.csv\nRelative probability of conversion between the different land uses\n\n\nsuitabilities.csv\nBinary (yes/no) suitability by land use capability for each land use\n\n\ninput-costs.csv\nMean and st dev. of costs per ha. of inputs by land use and land use capability\n\n\ncommodity-yields.csv\nMean and st dev. of yields (in appropriate units) per ha. of output by land use and land use capability\n\n\nprices.csv\nMarket price (per unit of output) by land use\n\n\nghg-emissions.csv\nMean and st dev. of GHG emissions (in appropriate units) per ha. of output by land use and land use capability\n\n\n\nThe first of these files (farmer-threshold-matrix.csv) effectively defines the available land use types and interventions and additional rows or columns could be added to it to further detail the model’s representation. Note: Extending the model in this way to add interventions is trivial; adding additional land uses will require additional code to deal with visualisation aspects.\nThe first 4 files effectively define the decision space of farmers in the model. The latter 4 define the market constraints (costs, yields, prices, emissions).\n\n\nGeographical setting\nThe geographical setting of the model can be initialised randomly or from GIS files (controlled by a switch in the model GUI).\nRandom initialisation first sets up a land use capability (LUC) landscape either using iterative smoothing3, pp 60-63), or using a voter model4, then randomly distributes farmers across the landscape assigning them a farm based on Voronoi polygons5 and breaking the farm into sub-farm level holdings based on contiguouse areas of the same LUC.\nInitialisation from GIS files uses a parcels.shp shapefile and luc.asc raster file to specify define respectively the farms and LUC landscape of the model. Farms are again subdivided into holdings based on LUC. Different catchments can be applied by providing these files in a folder data/spatial/&lt;region-name&gt;. Model development has been based on data for the Rangitaiki catchment to test this setup. Currently initialisation from files sets land use randomly (no such attribute is available in the parcels.shp file), but we anticipate that ‘localisation’ of the model to particular catchments will be relatively straightforward given appropriate spatial data files.\n\n\n\n\n\n\nUpdate History\n\n\n\n\n\n\n\n\nDate\nChanges\n\n\n\n\n2025-02-14\nInitial post.",
    "crumbs": [
      "Documents",
      "Overall model structure"
    ]
  },
  {
    "objectID": "model-description/documents/00-overall-model-structure.html#footnotes",
    "href": "model-description/documents/00-overall-model-structure.html#footnotes",
    "title": "Overall model structure",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nThe reason for this difference is an implementation detail in NetLogo. Agents (which farmers, farms, and holdings are) can always directly access attributes of the grid cells they are in. If the land use attribute had the same name both in grid cells and in the various agents, then accessing landuse would be ambiguous: does it refer to the agent’s attribute or the grid cell’s attribute? Naming the attribute differently resolves the ambiguity.↩︎\nTermed ‘turtles’ in NetLogo land due to NetLogo’s origins in the Logo programming language which introduced ‘turtle graphics’. See Resnick M. 1994. Turtles, Termites, and Traffic Jams: Explorations in Massively Parallel Microworlds. Cambridge MA: MIT Press.↩︎\nSee pages 60-63 in O’Sullivan D and GLW Perry. 2013. Spatial Simulation: Exploring Pattern and Process. Chichester, UK: Wiley.↩︎\nSee pages 80-81 in O’Sullivan D and GLW Perry. 2013. Spatial Simulation: Exploring Pattern and Process. Chichester, UK: Wiley.↩︎\nOkabe A, B Boots, K Sugihara, and SN Chiu. 2000. Spatial Tessellations: Concepts and Applications of Voronoi Diagrams. 2nd edn. Chichester, UK: Wiley.↩︎",
    "crumbs": [
      "Documents",
      "Overall model structure"
    ]
  }
]